var as=Object.defineProperty;var is=(t,s,n)=>s in t?as(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n;var Q=(t,s,n)=>(is(t,typeof s!="symbol"?s+"":s,n),n);import{r as p,a as os,R as U}from"./vendor-b1791c80.js";import{c as ls,a as kt}from"./utils-2aeefcae.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var jt={exports:{}},Te={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cs=p,ds=Symbol.for("react.element"),ms=Symbol.for("react.fragment"),us=Object.prototype.hasOwnProperty,hs=cs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,gs={key:!0,ref:!0,__self:!0,__source:!0};function Nt(t,s,n){var r,a={},i=null,o=null;n!==void 0&&(i=""+n),s.key!==void 0&&(i=""+s.key),s.ref!==void 0&&(o=s.ref);for(r in s)us.call(s,r)&&!gs.hasOwnProperty(r)&&(a[r]=s[r]);if(t&&t.defaultProps)for(r in s=t.defaultProps,s)a[r]===void 0&&(a[r]=s[r]);return{$$typeof:ds,type:t,key:i,ref:o,props:a,_owner:hs.current}}Te.Fragment=ms;Te.jsx=Nt;Te.jsxs=Nt;jt.exports=Te;var e=jt.exports;var We={},Xe=os;We.createRoot=Xe.createRoot,We.hydrateRoot=Xe.hydrateRoot;const Ct=p.createContext(void 0),St=()=>{const t=p.useContext(Ct);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t},ps=({children:t})=>{const[s,n]=p.useState(()=>{const a=localStorage.getItem("theme");return(a==="dark"||a==="light"?a:null)||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});p.useEffect(()=>{const a=window.document.documentElement;a.classList.remove("light","dark"),a.classList.add(s),localStorage.setItem("theme",s)},[s]);const r=()=>{n(a=>a==="light"?"dark":"light")};return e.jsx(Ct.Provider,{value:{theme:s,toggleTheme:r},children:t})},Ve="-",fs=t=>{const s=bs(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:o=>{const l=o.split(Ve);return l[0]===""&&l.length!==1&&l.shift(),At(l,s)||xs(o)},getConflictingClassGroupIds:(o,l)=>{const c=n[o]||[];return l&&r[o]?[...c,...r[o]]:c}}},At=(t,s)=>{var o;if(t.length===0)return s.classGroupId;const n=t[0],r=s.nextPart.get(n),a=r?At(t.slice(1),r):void 0;if(a)return a;if(s.validators.length===0)return;const i=t.join(Ve);return(o=s.validators.find(({validator:l})=>l(i)))==null?void 0:o.classGroupId},et=/^\[(.+)\]$/,xs=t=>{if(et.test(t)){const s=et.exec(t)[1],n=s==null?void 0:s.substring(0,s.indexOf(":"));if(n)return"arbitrary.."+n}},bs=t=>{const{theme:s,classGroups:n}=t,r={nextPart:new Map,validators:[]};for(const a in n)Ke(n[a],r,a,s);return r},Ke=(t,s,n,r)=>{t.forEach(a=>{if(typeof a=="string"){const i=a===""?s:tt(s,a);i.classGroupId=n;return}if(typeof a=="function"){if(ys(a)){Ke(a(r),s,n,r);return}s.validators.push({validator:a,classGroupId:n});return}Object.entries(a).forEach(([i,o])=>{Ke(o,tt(s,i),n,r)})})},tt=(t,s)=>{let n=t;return s.split(Ve).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},ys=t=>t.isThemeGetter,vs=t=>{if(t<1)return{get:()=>{},set:()=>{}};let s=0,n=new Map,r=new Map;const a=(i,o)=>{n.set(i,o),s++,s>t&&(s=0,r=n,n=new Map)};return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return a(i,o),o},set(i,o){n.has(i)?n.set(i,o):a(i,o)}}},Ge="!",He=":",ws=He.length,ks=t=>{const{prefix:s,experimentalParseClassName:n}=t;let r=a=>{const i=[];let o=0,l=0,c=0,u;for(let f=0;f<a.length;f++){let b=a[f];if(o===0&&l===0){if(b===He){i.push(a.slice(c,f)),c=f+ws;continue}if(b==="/"){u=f;continue}}b==="["?o++:b==="]"?o--:b==="("?l++:b===")"&&l--}const h=i.length===0?a:a.substring(c),x=js(h),d=x!==h,g=u&&u>c?u-c:void 0;return{modifiers:i,hasImportantModifier:d,baseClassName:x,maybePostfixModifierPosition:g}};if(s){const a=s+He,i=r;r=o=>o.startsWith(a)?i(o.substring(a.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:o,maybePostfixModifierPosition:void 0}}if(n){const a=r;r=i=>n({className:i,parseClassName:a})}return r},js=t=>t.endsWith(Ge)?t.substring(0,t.length-1):t.startsWith(Ge)?t.substring(1):t,Ns=t=>{const s=Object.fromEntries(t.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const a=[];let i=[];return r.forEach(o=>{o[0]==="["||s[o]?(a.push(...i.sort(),o),i=[]):i.push(o)}),a.push(...i.sort()),a}},Cs=t=>({cache:vs(t.cacheSize),parseClassName:ks(t),sortModifiers:Ns(t),...fs(t)}),Ss=/\s+/,As=(t,s)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:a,sortModifiers:i}=s,o=[],l=t.trim().split(Ss);let c="";for(let u=l.length-1;u>=0;u-=1){const h=l[u],{isExternal:x,modifiers:d,hasImportantModifier:g,baseClassName:f,maybePostfixModifierPosition:b}=n(h);if(x){c=h+(c.length>0?" "+c:c);continue}let y=!!b,A=r(y?f.substring(0,b):f);if(!A){if(!y){c=h+(c.length>0?" "+c:c);continue}if(A=r(f),!A){c=h+(c.length>0?" "+c:c);continue}y=!1}const S=i(d).join(":"),I=g?S+Ge:S,R=I+A;if(o.includes(R))continue;o.push(R);const m=a(A,y);for(let v=0;v<m.length;++v){const z=m[v];o.push(I+z)}c=h+(c.length>0?" "+c:c)}return c};function Es(){let t=0,s,n,r="";for(;t<arguments.length;)(s=arguments[t++])&&(n=Et(s))&&(r&&(r+=" "),r+=n);return r}const Et=t=>{if(typeof t=="string")return t;let s,n="";for(let r=0;r<t.length;r++)t[r]&&(s=Et(t[r]))&&(n&&(n+=" "),n+=s);return n};function Is(t,...s){let n,r,a,i=o;function o(c){const u=s.reduce((h,x)=>x(h),t());return n=Cs(u),r=n.cache.get,a=n.cache.set,i=l,l(c)}function l(c){const u=r(c);if(u)return u;const h=As(c,n);return a(c,h),h}return function(){return i(Es.apply(null,arguments))}}const G=t=>{const s=n=>n[t]||[];return s.isThemeGetter=!0,s},It=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,_t=/^\((?:(\w[\w-]*):)?(.+)\)$/i,_s=/^\d+\/\d+$/,zs=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Ts=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Ms=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,Rs=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Os=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ce=t=>_s.test(t),P=t=>!!t&&!Number.isNaN(Number(t)),ae=t=>!!t&&Number.isInteger(Number(t)),Re=t=>t.endsWith("%")&&P(t.slice(0,-1)),ne=t=>zs.test(t),Ls=()=>!0,Ps=t=>Ts.test(t)&&!Ms.test(t),zt=()=>!1,Bs=t=>Rs.test(t),Ds=t=>Os.test(t),Fs=t=>!N(t)&&!C(t),$s=t=>de(t,Rt,zt),N=t=>It.test(t),ie=t=>de(t,Ot,Ps),Oe=t=>de(t,Us,P),st=t=>de(t,Tt,zt),Ws=t=>de(t,Mt,Ds),Ce=t=>de(t,Lt,Bs),C=t=>_t.test(t),ue=t=>me(t,Ot),Ks=t=>me(t,Vs),nt=t=>me(t,Tt),Gs=t=>me(t,Rt),Hs=t=>me(t,Mt),Se=t=>me(t,Lt,!0),de=(t,s,n)=>{const r=It.exec(t);return r?r[1]?s(r[1]):n(r[2]):!1},me=(t,s,n=!1)=>{const r=_t.exec(t);return r?r[1]?s(r[1]):n:!1},Tt=t=>t==="position"||t==="percentage",Mt=t=>t==="image"||t==="url",Rt=t=>t==="length"||t==="size"||t==="bg-size",Ot=t=>t==="length",Us=t=>t==="number",Vs=t=>t==="family-name",Lt=t=>t==="shadow",qs=()=>{const t=G("color"),s=G("font"),n=G("text"),r=G("font-weight"),a=G("tracking"),i=G("leading"),o=G("breakpoint"),l=G("container"),c=G("spacing"),u=G("radius"),h=G("shadow"),x=G("inset-shadow"),d=G("text-shadow"),g=G("drop-shadow"),f=G("blur"),b=G("perspective"),y=G("aspect"),A=G("ease"),S=G("animate"),I=()=>["auto","avoid","all","avoid-page","page","left","right","column"],R=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],m=()=>[...R(),C,N],v=()=>["auto","hidden","clip","visible","scroll"],z=()=>["auto","contain","none"],k=()=>[C,N,c],F=()=>[ce,"full","auto",...k()],_=()=>[ae,"none","subgrid",C,N],K=()=>["auto",{span:["full",ae,C,N]},ae,C,N],ee=()=>[ae,"auto",C,N],se=()=>["auto","min","max","fr",C,N],te=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],W=()=>["start","end","center","stretch","center-safe","end-safe"],B=()=>["auto",...k()],L=()=>[ce,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...k()],j=()=>[t,C,N],w=()=>[...R(),nt,st,{position:[C,N]}],T=()=>["no-repeat",{repeat:["","x","y","space","round"]}],E=()=>["auto","cover","contain",Gs,$s,{size:[C,N]}],D=()=>[Re,ue,ie],O=()=>["","none","full",u,C,N],J=()=>["",P,ue,ie],we=()=>["solid","dashed","dotted","double"],Qe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],H=()=>[P,Re,nt,st],Ze=()=>["","none",f,C,N],ke=()=>["none",P,C,N],je=()=>["none",P,C,N],Me=()=>[P,C,N],Ne=()=>[ce,"full",...k()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ne],breakpoint:[ne],color:[Ls],container:[ne],"drop-shadow":[ne],ease:["in","out","in-out"],font:[Fs],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ne],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ne],shadow:[ne],spacing:["px",P],text:[ne],"text-shadow":[ne],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",ce,N,C,y]}],container:["container"],columns:[{columns:[P,N,C,l]}],"break-after":[{"break-after":I()}],"break-before":[{"break-before":I()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:m()}],overflow:[{overflow:v()}],"overflow-x":[{"overflow-x":v()}],"overflow-y":[{"overflow-y":v()}],overscroll:[{overscroll:z()}],"overscroll-x":[{"overscroll-x":z()}],"overscroll-y":[{"overscroll-y":z()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:F()}],"inset-x":[{"inset-x":F()}],"inset-y":[{"inset-y":F()}],start:[{start:F()}],end:[{end:F()}],top:[{top:F()}],right:[{right:F()}],bottom:[{bottom:F()}],left:[{left:F()}],visibility:["visible","invisible","collapse"],z:[{z:[ae,"auto",C,N]}],basis:[{basis:[ce,"full","auto",l,...k()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[P,ce,"auto","initial","none",N]}],grow:[{grow:["",P,C,N]}],shrink:[{shrink:["",P,C,N]}],order:[{order:[ae,"first","last","none",C,N]}],"grid-cols":[{"grid-cols":_()}],"col-start-end":[{col:K()}],"col-start":[{"col-start":ee()}],"col-end":[{"col-end":ee()}],"grid-rows":[{"grid-rows":_()}],"row-start-end":[{row:K()}],"row-start":[{"row-start":ee()}],"row-end":[{"row-end":ee()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":se()}],"auto-rows":[{"auto-rows":se()}],gap:[{gap:k()}],"gap-x":[{"gap-x":k()}],"gap-y":[{"gap-y":k()}],"justify-content":[{justify:[...te(),"normal"]}],"justify-items":[{"justify-items":[...W(),"normal"]}],"justify-self":[{"justify-self":["auto",...W()]}],"align-content":[{content:["normal",...te()]}],"align-items":[{items:[...W(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...W(),{baseline:["","last"]}]}],"place-content":[{"place-content":te()}],"place-items":[{"place-items":[...W(),"baseline"]}],"place-self":[{"place-self":["auto",...W()]}],p:[{p:k()}],px:[{px:k()}],py:[{py:k()}],ps:[{ps:k()}],pe:[{pe:k()}],pt:[{pt:k()}],pr:[{pr:k()}],pb:[{pb:k()}],pl:[{pl:k()}],m:[{m:B()}],mx:[{mx:B()}],my:[{my:B()}],ms:[{ms:B()}],me:[{me:B()}],mt:[{mt:B()}],mr:[{mr:B()}],mb:[{mb:B()}],ml:[{ml:B()}],"space-x":[{"space-x":k()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":k()}],"space-y-reverse":["space-y-reverse"],size:[{size:L()}],w:[{w:[l,"screen",...L()]}],"min-w":[{"min-w":[l,"screen","none",...L()]}],"max-w":[{"max-w":[l,"screen","none","prose",{screen:[o]},...L()]}],h:[{h:["screen","lh",...L()]}],"min-h":[{"min-h":["screen","lh","none",...L()]}],"max-h":[{"max-h":["screen","lh",...L()]}],"font-size":[{text:["base",n,ue,ie]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,C,Oe]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Re,N]}],"font-family":[{font:[Ks,N,s]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,C,N]}],"line-clamp":[{"line-clamp":[P,"none",C,Oe]}],leading:[{leading:[i,...k()]}],"list-image":[{"list-image":["none",C,N]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",C,N]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:j()}],"text-color":[{text:j()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...we(),"wavy"]}],"text-decoration-thickness":[{decoration:[P,"from-font","auto",C,ie]}],"text-decoration-color":[{decoration:j()}],"underline-offset":[{"underline-offset":[P,"auto",C,N]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:k()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",C,N]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",C,N]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:w()}],"bg-repeat":[{bg:T()}],"bg-size":[{bg:E()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},ae,C,N],radial:["",C,N],conic:[ae,C,N]},Hs,Ws]}],"bg-color":[{bg:j()}],"gradient-from-pos":[{from:D()}],"gradient-via-pos":[{via:D()}],"gradient-to-pos":[{to:D()}],"gradient-from":[{from:j()}],"gradient-via":[{via:j()}],"gradient-to":[{to:j()}],rounded:[{rounded:O()}],"rounded-s":[{"rounded-s":O()}],"rounded-e":[{"rounded-e":O()}],"rounded-t":[{"rounded-t":O()}],"rounded-r":[{"rounded-r":O()}],"rounded-b":[{"rounded-b":O()}],"rounded-l":[{"rounded-l":O()}],"rounded-ss":[{"rounded-ss":O()}],"rounded-se":[{"rounded-se":O()}],"rounded-ee":[{"rounded-ee":O()}],"rounded-es":[{"rounded-es":O()}],"rounded-tl":[{"rounded-tl":O()}],"rounded-tr":[{"rounded-tr":O()}],"rounded-br":[{"rounded-br":O()}],"rounded-bl":[{"rounded-bl":O()}],"border-w":[{border:J()}],"border-w-x":[{"border-x":J()}],"border-w-y":[{"border-y":J()}],"border-w-s":[{"border-s":J()}],"border-w-e":[{"border-e":J()}],"border-w-t":[{"border-t":J()}],"border-w-r":[{"border-r":J()}],"border-w-b":[{"border-b":J()}],"border-w-l":[{"border-l":J()}],"divide-x":[{"divide-x":J()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":J()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...we(),"hidden","none"]}],"divide-style":[{divide:[...we(),"hidden","none"]}],"border-color":[{border:j()}],"border-color-x":[{"border-x":j()}],"border-color-y":[{"border-y":j()}],"border-color-s":[{"border-s":j()}],"border-color-e":[{"border-e":j()}],"border-color-t":[{"border-t":j()}],"border-color-r":[{"border-r":j()}],"border-color-b":[{"border-b":j()}],"border-color-l":[{"border-l":j()}],"divide-color":[{divide:j()}],"outline-style":[{outline:[...we(),"none","hidden"]}],"outline-offset":[{"outline-offset":[P,C,N]}],"outline-w":[{outline:["",P,ue,ie]}],"outline-color":[{outline:j()}],shadow:[{shadow:["","none",h,Se,Ce]}],"shadow-color":[{shadow:j()}],"inset-shadow":[{"inset-shadow":["none",x,Se,Ce]}],"inset-shadow-color":[{"inset-shadow":j()}],"ring-w":[{ring:J()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:j()}],"ring-offset-w":[{"ring-offset":[P,ie]}],"ring-offset-color":[{"ring-offset":j()}],"inset-ring-w":[{"inset-ring":J()}],"inset-ring-color":[{"inset-ring":j()}],"text-shadow":[{"text-shadow":["none",d,Se,Ce]}],"text-shadow-color":[{"text-shadow":j()}],opacity:[{opacity:[P,C,N]}],"mix-blend":[{"mix-blend":[...Qe(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Qe()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[P]}],"mask-image-linear-from-pos":[{"mask-linear-from":H()}],"mask-image-linear-to-pos":[{"mask-linear-to":H()}],"mask-image-linear-from-color":[{"mask-linear-from":j()}],"mask-image-linear-to-color":[{"mask-linear-to":j()}],"mask-image-t-from-pos":[{"mask-t-from":H()}],"mask-image-t-to-pos":[{"mask-t-to":H()}],"mask-image-t-from-color":[{"mask-t-from":j()}],"mask-image-t-to-color":[{"mask-t-to":j()}],"mask-image-r-from-pos":[{"mask-r-from":H()}],"mask-image-r-to-pos":[{"mask-r-to":H()}],"mask-image-r-from-color":[{"mask-r-from":j()}],"mask-image-r-to-color":[{"mask-r-to":j()}],"mask-image-b-from-pos":[{"mask-b-from":H()}],"mask-image-b-to-pos":[{"mask-b-to":H()}],"mask-image-b-from-color":[{"mask-b-from":j()}],"mask-image-b-to-color":[{"mask-b-to":j()}],"mask-image-l-from-pos":[{"mask-l-from":H()}],"mask-image-l-to-pos":[{"mask-l-to":H()}],"mask-image-l-from-color":[{"mask-l-from":j()}],"mask-image-l-to-color":[{"mask-l-to":j()}],"mask-image-x-from-pos":[{"mask-x-from":H()}],"mask-image-x-to-pos":[{"mask-x-to":H()}],"mask-image-x-from-color":[{"mask-x-from":j()}],"mask-image-x-to-color":[{"mask-x-to":j()}],"mask-image-y-from-pos":[{"mask-y-from":H()}],"mask-image-y-to-pos":[{"mask-y-to":H()}],"mask-image-y-from-color":[{"mask-y-from":j()}],"mask-image-y-to-color":[{"mask-y-to":j()}],"mask-image-radial":[{"mask-radial":[C,N]}],"mask-image-radial-from-pos":[{"mask-radial-from":H()}],"mask-image-radial-to-pos":[{"mask-radial-to":H()}],"mask-image-radial-from-color":[{"mask-radial-from":j()}],"mask-image-radial-to-color":[{"mask-radial-to":j()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":R()}],"mask-image-conic-pos":[{"mask-conic":[P]}],"mask-image-conic-from-pos":[{"mask-conic-from":H()}],"mask-image-conic-to-pos":[{"mask-conic-to":H()}],"mask-image-conic-from-color":[{"mask-conic-from":j()}],"mask-image-conic-to-color":[{"mask-conic-to":j()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:w()}],"mask-repeat":[{mask:T()}],"mask-size":[{mask:E()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",C,N]}],filter:[{filter:["","none",C,N]}],blur:[{blur:Ze()}],brightness:[{brightness:[P,C,N]}],contrast:[{contrast:[P,C,N]}],"drop-shadow":[{"drop-shadow":["","none",g,Se,Ce]}],"drop-shadow-color":[{"drop-shadow":j()}],grayscale:[{grayscale:["",P,C,N]}],"hue-rotate":[{"hue-rotate":[P,C,N]}],invert:[{invert:["",P,C,N]}],saturate:[{saturate:[P,C,N]}],sepia:[{sepia:["",P,C,N]}],"backdrop-filter":[{"backdrop-filter":["","none",C,N]}],"backdrop-blur":[{"backdrop-blur":Ze()}],"backdrop-brightness":[{"backdrop-brightness":[P,C,N]}],"backdrop-contrast":[{"backdrop-contrast":[P,C,N]}],"backdrop-grayscale":[{"backdrop-grayscale":["",P,C,N]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[P,C,N]}],"backdrop-invert":[{"backdrop-invert":["",P,C,N]}],"backdrop-opacity":[{"backdrop-opacity":[P,C,N]}],"backdrop-saturate":[{"backdrop-saturate":[P,C,N]}],"backdrop-sepia":[{"backdrop-sepia":["",P,C,N]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":k()}],"border-spacing-x":[{"border-spacing-x":k()}],"border-spacing-y":[{"border-spacing-y":k()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",C,N]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[P,"initial",C,N]}],ease:[{ease:["linear","initial",A,C,N]}],delay:[{delay:[P,C,N]}],animate:[{animate:["none",S,C,N]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[b,C,N]}],"perspective-origin":[{"perspective-origin":m()}],rotate:[{rotate:ke()}],"rotate-x":[{"rotate-x":ke()}],"rotate-y":[{"rotate-y":ke()}],"rotate-z":[{"rotate-z":ke()}],scale:[{scale:je()}],"scale-x":[{"scale-x":je()}],"scale-y":[{"scale-y":je()}],"scale-z":[{"scale-z":je()}],"scale-3d":["scale-3d"],skew:[{skew:Me()}],"skew-x":[{"skew-x":Me()}],"skew-y":[{"skew-y":Me()}],transform:[{transform:[C,N,"","none","gpu","cpu"]}],"transform-origin":[{origin:m()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Ne()}],"translate-x":[{"translate-x":Ne()}],"translate-y":[{"translate-y":Ne()}],"translate-z":[{"translate-z":Ne()}],"translate-none":["translate-none"],accent:[{accent:j()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:j()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",C,N]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":k()}],"scroll-mx":[{"scroll-mx":k()}],"scroll-my":[{"scroll-my":k()}],"scroll-ms":[{"scroll-ms":k()}],"scroll-me":[{"scroll-me":k()}],"scroll-mt":[{"scroll-mt":k()}],"scroll-mr":[{"scroll-mr":k()}],"scroll-mb":[{"scroll-mb":k()}],"scroll-ml":[{"scroll-ml":k()}],"scroll-p":[{"scroll-p":k()}],"scroll-px":[{"scroll-px":k()}],"scroll-py":[{"scroll-py":k()}],"scroll-ps":[{"scroll-ps":k()}],"scroll-pe":[{"scroll-pe":k()}],"scroll-pt":[{"scroll-pt":k()}],"scroll-pr":[{"scroll-pr":k()}],"scroll-pb":[{"scroll-pb":k()}],"scroll-pl":[{"scroll-pl":k()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",C,N]}],fill:[{fill:["none",...j()]}],"stroke-w":[{stroke:[P,ue,ie,Oe]}],stroke:[{stroke:["none",...j()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Ys=Is(qs);function $(...t){return Ys(ls(t))}const Js=kt("inline-flex items-center justify-center gap-2 rounded-lg font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{variants:{variant:{primary:"bg-emerald-600 text-white shadow-sm hover:bg-emerald-700 hover:shadow-md focus:ring-emerald-500",secondary:"bg-white text-stone-700 border border-stone-300 shadow-sm hover:bg-stone-50 hover:shadow-md focus:ring-stone-500",success:"bg-green-600 text-white shadow-sm hover:bg-green-700 hover:shadow-md focus:ring-green-500",danger:"bg-red-600 text-white shadow-sm hover:bg-red-700 hover:shadow-md focus:ring-red-500",warning:"bg-orange-600 text-white shadow-sm hover:bg-orange-700 hover:shadow-md focus:ring-orange-500",ghost:"text-stone-600 hover:text-stone-900 hover:bg-stone-100 focus:ring-stone-500",outline:"border border-stone-300 bg-transparent text-stone-700 hover:bg-stone-50 focus:ring-stone-500"},size:{sm:"h-8 px-3 text-xs",md:"h-10 px-4 text-sm",lg:"h-12 px-6 text-base",xl:"h-14 px-8 text-lg"}},defaultVariants:{variant:"primary",size:"md"}}),M=U.forwardRef(({className:t,variant:s,size:n,loading:r,leftIcon:a,rightIcon:i,children:o,disabled:l,...c},u)=>e.jsxs("button",{className:$(Js({variant:s,size:n}),t),ref:u,disabled:l||r,...c,children:[r&&e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),!r&&a&&e.jsx("span",{className:"mr-1",children:a}),o,!r&&i&&e.jsx("span",{className:"ml-1",children:i})]}));M.displayName="Button";const rt={success:"bg-green-100 text-green-800 border-green-400 dark:bg-green-800 dark:text-green-100 dark:border-green-600",error:"bg-red-100 text-red-800 border-red-400 dark:bg-red-800 dark:text-red-100 dark:border-red-600",warning:"bg-yellow-100 text-yellow-800 border-yellow-400 dark:bg-yellow-700 dark:text-yellow-100 dark:border-yellow-500",info:"bg-blue-100 text-blue-800 border-blue-400 dark:bg-blue-800 dark:text-blue-100 dark:border-blue-600"},Qs=({message:t,type:s="info",onClose:n})=>e.jsxs("div",{className:`p-4 rounded-md shadow-lg border w-full flex items-start text-sm ${rt[s]||rt.info}`,"data-testid":"toast-message",role:"alert","aria-live":"assertive",children:[e.jsx("div",{className:"flex-1 font-medium",children:t}),e.jsx(M,{onClick:n,variant:"secondary",className:"ml-4 p-1 h-7 w-7 flex items-center justify-center text-slate-500 hover:text-slate-800 dark:text-slate-300 dark:hover:text-white","aria-label":"Toast schließen",title:"Schließen",children:"×"})]}),Zs=({toasts:t,removeToast:s})=>e.jsx("div",{className:"fixed top-4 right-4 z-[10001] space-y-3 w-full max-w-xs sm:max-w-sm",children:t.map(n=>e.jsx(Qs,{...n,onClose:()=>s(n.id)},n.id))}),Pt=p.createContext(null),Xs=({children:t})=>{const[s,n]=p.useState([]),r=p.useRef(0),a=p.useCallback(o=>{n(l=>l.filter(c=>c.id!==o))},[]),i=p.useCallback((o,l="info",c=3e3)=>{const u=r.current++;n(h=>[...h,{id:u,message:o,type:l}]),c&&c>0&&setTimeout(()=>a(u),c)},[a]);return e.jsxs(Pt.Provider,{value:{addToast:i,removeToast:a},children:[t,e.jsx(Zs,{toasts:s,removeToast:a})]})},be=()=>{const t=p.useContext(Pt);if(!t)throw new Error("useToasts must be used within a ToastProvider");return t},Le={tapWater:{name:"Leitungswasser",ph:7.5,ec:.5,ca:50,mg:10,na:20,s:5,fe:.05,mn:.02,zn:.01,cu:.005,b:.01,mo:.001},roWater:{name:"Umkehrosmosewasser",ph:6.5,ec:.05,ca:0,mg:0,na:0,s:0,fe:0,mn:0,zn:0,cu:0,b:0,mo:0}},ge="nutricalc_custom_fertilizers",en="basic",tn="advanced",sn="analysis",nn="customFertilizer",Bt="ai-assistant",Ue="settings",rn="references",Dt="mixingassistant",Ft="watering",V=[{id:en,label:"Setup"},{id:tn,label:"Details"},{id:sn,label:"Analyse"},{id:nn,label:"Dünger"},{id:Bt,label:"AI-Assistent"},{id:Ue,label:"Einstellungen"},{id:Dt,label:"Misch-Assistent"},{id:Ft,label:"Gießplaner"},{id:rn,label:"Referenzen"}],oe={early_veg:{name:"Frühe Vegetation",n:[100,150],p:[30,50],k:[100,150],ec:[.8,1.2]},late_veg:{name:"Späte Vegetation",n:[150,200],p:[50,70],k:[150,200],ec:[1.2,1.6]},early_flower:{name:"Frühe Blüte",n:[100,150],p:[70,90],k:[200,250],ec:[1.4,1.8]},mid_flower:{name:"Mittlere Blüte",n:[80,120],p:[90,110],k:[250,300],ec:[1.6,2]},late_flower:{name:"Späte Blüte",n:[50,80],p:[110,130],k:[300,350],ec:[1.8,2.2]}},he={ro:{name:"Umkehrosmose"},tap:{name:"Leitungswasser"},custom:{name:"Eigenes Profil"}},re=[{key:"n",label:"Stickstoff (N)"},{key:"p",label:"Phosphor (P)"},{key:"k",label:"Kalium (K)"},{key:"ca",label:"Calcium (Ca)"},{key:"mg",label:"Magnesium (Mg)"},{key:"s",label:"Schwefel (S)"},{key:"fe",label:"Eisen (Fe)"},{key:"mn",label:"Mangan (Mn)"},{key:"zn",label:"Zink (Zn)"},{key:"cu",label:"Kupfer (Cu)"},{key:"b",label:"Bor (B)"},{key:"mo",label:"Molybdän (Mo)"},{key:"ec",label:"EC"}],at={atami_ata_calmag:{name:"Atami ATA CalMag",type:"liquid",unit:"ml",composition:{n:72.616,p:0,k:0,ca:60.87224,mg:18.8739,s:0,b:0,cu:0,fe:.3756,mn:0,mo:0,zn:0}},atami_ata_clean:{name:"Atami ATA Clean",type:"liquid",unit:"ml",composition:{n:10.36,p:101.159702,k:65.581649,ca:0,mg:0,s:0,b:0,cu:0,fe:.3885,mn:0,mo:0,zn:0}},atami_ata_terra_leaves:{name:"Atami ATA Terra Leaves",type:"liquid",unit:"ml",composition:{n:23.69,p:4.944412,k:23.942968,ca:0,mg:6.83199,s:0,b:0,cu:0,fe:0,mn:0,mo:0,zn:0}},atami_ata_terra_max:{name:"Atami ATA Terra Max",type:"liquid",unit:"ml",composition:{n:24.42,p:8.719272,k:35.939358,ca:0,mg:4.68531,s:0,b:0,cu:0,fe:0,mn:0,mo:0,zn:0}},atami_bcuzz_bloom_stimulator:{name:"Atami B'cuzz Bloom Stimulator",type:"liquid",unit:"ml",composition:{n:.998,p:.78394896,k:1.98849504,ca:1.997996,mg:1.203588,s:.51896,b:0,cu:.00499,fe:0,mn:0,mo:0,zn:.00499}},atami_bcuzz_blossom_builder:{name:"Atami B'cuzz Blossom Builder",type:"liquid",unit:"ml",description:"",composition:{n:0,p:108.017728,k:254.0412,ca:0,mg:0,s:0,b:0,cu:0,fe:0,mn:0,mo:0,zn:0}},atami_bcuzz_coco_nutrition_a:{name:"Atami B'cuzz Coco Nutrition A",type:"liquid",unit:"ml",description:"",composition:{n:60.75,p:0,k:50.43465,ca:48.6486,mg:0,s:0,b:0,cu:0,fe:0,mn:0,mo:0,zn:0}},atami_bcuzz_coco_nutrition_b:{name:"Atami B'cuzz Coco Nutrition B",type:"liquid",unit:"ml",description:"",composition:{n:0,p:19.847472,k:56.636244,ca:0,mg:0,s:0,b:0,cu:0,fe:0,mn:0,mo:0,zn:0}},atami_bcuzz_premium_plant_powder:{name:"Atami B'cuzz Premium Plant Powder",type:"powder",unit:"g",description:"",composition:{n:90,p:30.548,k:141.134,ca:28.6,mg:18.09,s:0,b:.2,cu:.004,fe:.9,mn:.4,mo:.03,zn:.5}},athena_blended_bloom_a:{name:"Athena Blended Bloom A",type:"liquid",unit:"ml",description:"",composition:{n:47.8,p:0,k:49.60445,ca:38.27824,mg:2.0320497,s:0,b:.1195,cu:0,fe:.717,mn:.15535,mo:.008365,zn:.053775}},athena_blended_bloom_b:{name:"Athena Blended Bloom B",type:"liquid",unit:"ml",composition:{n:8.078,p:30.216336,k:47.90254,ca:0,mg:10.8554472,s:15.002,b:0,cu:.0577,fe:0,mn:0,mo:0,zn:0}},athena_blended_camg:{name:"Athena Blended CaMg",type:"liquid",unit:"ml",composition:{n:22.24,p:0,k:0,ca:23.375352,mg:12.23057664,s:0,b:0,cu:0,fe:.6672,mn:0,mo:0,zn:0}},athena_blended_grow_a:{name:"Athena Blended Grow A",type:"liquid",unit:"ml",composition:{n:48.36,p:0,k:10.037118,ca:50.828778,mg:2.29643505,s:0,b:.1209,cu:0,fe:.7254,mn:.15717,mo:.008463,zn:.054405}},athena_blended_grow_b:{name:"Athena Blended Grow B",type:"liquid",unit:"ml",composition:{n:11.4,p:14.92488,k:47.3214,ca:0,mg:10.1531934,s:14.82,b:0,cu:.057,fe:0,mn:0,mo:0,zn:0}},athena_blended_pk:{name:"Athena Blended PK",type:"liquid",unit:"ml",composition:{n:0,p:26.655312,k:63.38577,ca:0,mg:14.6404179,s:22.905,b:0,cu:0,fe:0,mn:0,mo:0,zn:0}},athena_pro_bloom:{name:"Athena Pro Bloom",type:"powder",unit:"g",composition:{n:0,p:52.368,k:199.248,ca:0,mg:30.0294,s:90,b:0,cu:0,fe:1,mn:0,mo:0,zn:0}},athena_pro_core:{name:"Athena Pro Core",type:"powder",unit:"g",composition:{n:140,p:0,k:0,ca:170.17,mg:0,s:0,b:.15,cu:.1,fe:.7,mn:.25,mo:.02,zn:.1}},athena_pro_fade:{name:"Athena Pro Fade",type:"liquid",unit:"ml",composition:{n:0,p:0,k:0,ca:44.52448,mg:0,s:0,b:.1112,cu:.0556,fe:.6672,mn:.14456,mo:.007784,zn:.05004}},athena_pro_grow:{name:"Athena Pro Grow",type:"powder",unit:"g",composition:{n:20,p:34.912,k:166.04,ca:0,mg:30.0294,s:80,b:0,cu:0,fe:1,mn:0,mo:0,zn:0}},biobizz_alg_a_mic:{name:"BioBizz Alg-a-mic",type:"liquid",unit:"ml",composition:{n:2.088,p:.9112032,k:1.7334576,ca:1.045044,mg:1.04502312,s:0,b:0,cu:0,fe:0,mn:0,mo:0,zn:0}},biobizz_bio_bloom:{name:"BioBizz Bio Bloom",type:"liquid",unit:"ml",composition:{n:21.1464,p:30.24828048,k:38.65809696,ca:0,mg:0,s:0,b:0,cu:0,fe:0,mn:0,mo:0,zn:0}},biobizz_bio_grow:{name:"BioBizz Bio Grow",type:"liquid",unit:"ml",composition:{n:54.6,p:17.0196,k:64.7556,ca:0,mg:0,s:0,b:0,cu:0,fe:0,mn:0,mo:0,zn:0}},biobizz_bio_heaven:{name:"BioBizz Bio Heaven",type:"liquid",unit:"ml",composition:{n:12.288,p:.13406208,k:.17002496,ca:2.855424,mg:.1234944,s:0,b:.1024,cu:0,fe:2.56,mn:0,mo:0,zn:.03072}},biobizz_calmag:{name:"BioBizz CalMag",type:"liquid",unit:"ml",composition:{n:0,p:0,k:0,ca:35.31528,mg:12.055176,s:0,b:0,cu:0,fe:0,mn:0,mo:0,zn:0}},biobizz_fish_mix:{name:"BioBizz Fish Mix",type:"liquid",unit:"ml",composition:{n:61.1,p:5.332808,k:40.580176,ca:0,mg:0,s:0,b:0,cu:0,fe:0,mn:0,mo:0,zn:0}},biobizz_root_juice:{name:"BioBizz Root Juice",type:"liquid",unit:"ml",composition:{n:2.3092,p:.8762912,k:1.08357704,ca:0,mg:.0605412,s:0,b:0,cu:0,fe:0,mn:0,mo:0,zn:0}},biobizz_top_max:{name:"BioBizz Top Max",type:"liquid",unit:"ml",composition:{n:1.7068,p:.8762912,k:1.16692912,ca:0,mg:.1816236,s:0,b:.11044,cu:.01004,fe:.1004,mn:0,mo:0,zn:.03012}}},$t=p.createContext(void 0),an=({children:t})=>{const[s,n]=p.useState([{id:"tapWater",...Le.tapWater,volume:100},{id:"roWater",...Le.roWater,volume:0}]),[r,a]=p.useState(null);p.useEffect(()=>{i()},[s]);const i=()=>{if(s.length===0){a(null);return}let u=0,h=0;const x={};if(re.forEach(y=>{x[y.key]=0}),x.ec=0,s.forEach(y=>{const{ph:A,ec:S,volume:I}=y;if(I>0){const R=Math.pow(10,-A);u+=R*I,h+=I,re.forEach(m=>{x[m.key]+=(y[m.key]||0)*I}),x.ec+=S*I}}),h===0){a(null);return}const d=u/h,g=-Math.log10(d),f={};re.forEach(y=>{f[y.key]=x[y.key]/h});const b=x.ec/h;a({ph:g,ec:b,...f,totalVolume:h})},o=u=>{const h={id:`${u}-${Date.now()}`,...Le[u]||{name:"Neue Quelle",ph:7,ec:.2,ca:0,mg:0,na:0,s:0,fe:0,mn:0,zn:0,cu:0,b:0,mo:0},volume:0};n(x=>[...x,h])},l=u=>{n(h=>h.filter(x=>x.id!==u))},c=(u,h,x)=>{n(d=>d.map(g=>g.id===u?{...g,[h]:x}:g))};return e.jsx($t.Provider,{value:{waterSources:s,mixedWater:r,addWaterSource:o,removeWaterSource:l,updateWaterSource:c},children:t})},Wt=()=>{const t=p.useContext($t);if(!t)throw new Error("useWater must be used within a WaterProvider");return t},Kt=U.memo(({apiKey:t,onSend:s,isLoading:n,displayMessage:r,suggestions:a=[]})=>{const[i,o]=p.useState(""),l=p.useRef(null),c=h=>{h.preventDefault(),!(!i.trim()||!t)&&(s(i.trim()),o(""))},u=h=>{var x;o(h),(x=l.current)==null||x.focus()};return e.jsxs("div",{className:"bg-gradient-to-r from-emerald-50 to-blue-50 rounded-xl p-4 shadow-sm border border-stone-200",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 pt-0.5",children:e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-emerald-500 to-blue-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})})}),e.jsxs("div",{className:"flex-grow text-sm text-stone-700 min-h-[36px] leading-relaxed",children:[n&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-4 w-4 text-emerald-600",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"text-stone-500",children:"AI denkt nach..."})]}),!n&&r&&e.jsx("div",{className:"prose prose-sm max-w-none",children:r}),!n&&!r&&e.jsx("div",{className:"text-stone-500 italic",children:"Stellen Sie eine Frage zur Nährstoffberechnung..."})]})]}),!n&&r&&a.length>0&&e.jsxs("div",{className:"mt-4 pl-11",children:[e.jsx("div",{className:"text-xs text-stone-500 mb-2",children:"Vorschläge:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.map((h,x)=>e.jsx("button",{onClick:()=>u(h),className:"px-3 py-1 text-xs bg-white border border-stone-200 rounded-full hover:bg-stone-50 hover:border-emerald-300 transition-colors focus:outline-none focus:ring-2 focus:ring-emerald-500","aria-label":`Vorschlag: ${h}`,children:h},x))})]}),e.jsxs("form",{onSubmit:c,className:"mt-4 flex items-center gap-3 pl-11",children:[e.jsx("div",{className:"flex-1 relative",children:e.jsx("input",{ref:l,type:"text",value:i,onChange:h=>o(h.target.value),placeholder:t?"Stellen Sie eine Frage zur Nährstoffberechnung...":"API Key fehlt",className:"w-full px-4 py-2.5 bg-white border border-stone-300 rounded-lg text-stone-900 placeholder-stone-400 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors",disabled:n||!t,"aria-label":"KI Frage eingeben"})}),e.jsx(M,{type:"submit",variant:"primary",size:"md",loading:n,disabled:!i.trim()||!t,"aria-label":"Frage senden",rightIcon:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),children:"Fragen"})]})]})});Kt.displayName="ChatBar";function Gt({waterVolume:t,growthStage:s,waterType:n,selectedFertilizers:r,fertilizerDatabase:a,customWaterProfile:i,NUTRIENT_FIELDS:o,GROWTH_STAGES:l,WATER_TYPES:c,mixedWater:u}){if(t<=0)return{nutrients:{},contributions:{},stage:l[s]};let h={},x=0,d=0;if(u)o.forEach(y=>{h[y.key]=u[y.key]||0}),x=u.ec||0,d=u.ph||0;else if(n==="custom")h={ca:(i==null?void 0:i.ca)||0,mg:(i==null?void 0:i.mg)||0,s:(i==null?void 0:i.s)||0,na:(i==null?void 0:i.na)||0,cl:(i==null?void 0:i.cl)||0,no3:(i==null?void 0:i.no3)||0,so4:(i==null?void 0:i.so4)||0,po4:(i==null?void 0:i.po4)||0},x=(i==null?void 0:i.baseEC)||0,d=(i==null?void 0:i.ph)||0;else{const y=c[n];h={ca:y.ca||0,mg:y.mg||0,s:y.s||0,na:0,cl:0,no3:0,so4:0,po4:0},x=y.baseEC!==void 0?y.baseEC:0,d=y.ph||0}const g=o.reduce((y,A)=>(y[A.key]=0,y),{});o.forEach(y=>{g[y.key]=h[y.key]||0}),g.ec=x,g.ph=d;const f={};let b=0;return(r||[]).forEach(y=>{if(!y.active||!y.amount||Number(y.amount)===0)return;const A=a[y.id];if(!(A!=null&&A.composition))return;const S={},I=Number(y.amount);Object.keys(A.composition).forEach(R=>{const m=Number(A.composition[R])||0;if(m===0||!o.find(z=>z.key===R))return;const v=A.type==="powder"?I*m*10/t:I*m/t;S[R]=v,g[R]=(g[R]||0)+v}),f[y.id]=S}),b=((g.n||0)-(h.n||0))*.007+((g.p||0)-(h.p||0))*.005+((g.k||0)-(h.k||0))*.008+((g.ca||0)-h.ca)*.006+((g.mg||0)-h.mg)*.004+((g.s||0)-h.s)*.003,g.ec=x+Math.max(0,b),Object.keys(g).forEach(y=>{g[y]=Number(Math.round(g[y]*100)/100),isNaN(g[y])&&(g[y]=0)}),{nutrients:g,contributions:f,stage:l[s]}}const Ht=U.memo(({selectedFertilizers:t,fertilizerDatabase:s,waterVolume:n,addFertilizer:r,removeFertilizer:a,updateFertilizerAmount:i,toggleFertilizer:o})=>e.jsxs("div",{className:"space-y-2 max-h-[400px] lg:max-h-[calc(100vh-350px)] overflow-y-auto p-0.5",children:[(t||[]).map(l=>{const c=s[l.id];return c?e.jsxs("div",{className:`p-2 border rounded-md ${l.active?"bg-white dark:bg-slate-800 border-blue-300 dark:border-blue-600":"bg-slate-100 dark:bg-slate-900/50 border-slate-300 dark:border-slate-700"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{type:"checkbox",id:`fertActive-${l.id}`,checked:l.active,onChange:()=>o(l.id),className:"w-3.5 h-3.5 text-blue-600 dark:text-blue-500 border-slate-300 dark:border-slate-600 rounded focus:ring-1 focus:ring-blue-500 dark:focus:ring-blue-400 bg-white dark:bg-slate-700","aria-label":`Aktivieren ${c.name}`}),e.jsx("div",{children:e.jsxs("label",{htmlFor:`fertActive-${l.id}`,className:"text-xs font-medium text-slate-700 dark:text-slate-200 cursor-pointer",children:[c.name,l.id&&l.id.startsWith("custom_")&&e.jsx("span",{className:"ml-1 px-1 py-0.5 text-[10px] bg-yellow-200 dark:bg-yellow-700 text-yellow-800 dark:text-yellow-100 rounded align-middle",children:"Custom"})]})})]}),e.jsx(M,{onClick:()=>a(l.id),variant:"danger",className:"p-0.5 h-7 w-7 flex items-center justify-center text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300","aria-label":`Entfernen ${c.name}`,title:`Entfernen ${c.name}`,children:"×"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{type:"number",value:l.amount,onChange:u=>i(l.id,u.target.value),disabled:!l.active,className:"flex-1 px-2 py-1 border rounded-md text-xs disabled:opacity-60 dark:bg-slate-700 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:c.type==="powder"?"0.01":"0.1","aria-label":`Menge für ${c.name}`}),e.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400 min-w-fit",children:[c.unit,"/",n>0?n:1,"L"]})]})]},l.id):null}),e.jsx("div",{className:"border-t border-slate-300 dark:border-slate-700 pt-2 mt-2",children:e.jsxs("select",{onChange:l=>r(l.target.value),className:"w-full px-2 py-1 border rounded-md text-xs dark:bg-slate-700 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500",value:"","aria-label":"Dünger hinzufügen",children:[e.jsx("option",{value:"",children:"Dünger hinzufügen..."}),Object.entries(s).sort(([,l],[,c])=>l.name.localeCompare(c.name)).map(([l,c])=>e.jsxs("option",{value:l,disabled:(t||[]).some(u=>u.id===l),children:[c.name,l.startsWith("custom_")?" (Custom)":""]},l))]})})]}));Ht.displayName="FertilizerManager";const qe=()=>{const[t,s]=p.useState(()=>{try{const r=localStorage.getItem("appSettings");return r?JSON.parse(r):{unit:"liter",waterAmount:"",growthPhase:"",waterType:""}}catch{return{unit:"liter",waterAmount:"",growthPhase:"",waterType:""}}});return p.useEffect(()=>{try{localStorage.setItem("appSettings",JSON.stringify(t))}catch{}},[t]),{settings:t,updateSetting:(r,a)=>{s(i=>({...i,[r]:a}))}}},Ut=U.memo(()=>{const{waterSources:t,mixedWater:s,addWaterSource:n,removeWaterSource:r,updateWaterSource:a}=Wt(),{settings:i}=qe(),o=(l,c,u)=>{const h=parseFloat(u),x=isNaN(h)?0:Math.max(0,h);a(l,c,x)};return e.jsxs("div",{className:"p-4 bg-gray-800 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-white",children:"Wasserqualität & Mischung"}),t.map(l=>e.jsxs("div",{className:"mb-4 p-3 border border-gray-700 rounded-md bg-gray-750",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:l.name}),t.length>1&&e.jsx(M,{onClick:()=>r(l.id),variant:"danger",className:"text-red-400 hover:text-red-500 font-bold py-1 px-2 text-xs","aria-label":`Wasserquelle ${l.name} entfernen`,title:`Wasserquelle ${l.name} entfernen`,children:"Entfernen"})]}),e.jsx("h4",{className:"text-md font-semibold text-gray-200 mb-2",children:"Basische Parameter"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-4",children:[e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-300",children:"pH-Wert:"}),e.jsx("input",{type:"number",step:"0.01",value:l.ph,onChange:c=>o(l.id,"ph",c.target.value),className:"w-full px-2 py-1 border rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-slate-100 bg-white text-gray-900 mt-1 block"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-300",children:"EC (mS/cm):"}),e.jsx("input",{type:"number",step:"0.01",value:l.ec,onChange:c=>o(l.id,"ec",c.target.value),className:"w-full px-2 py-1 border rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-slate-100 bg-white text-gray-900 mt-1 block"})]})]}),e.jsx("h4",{className:"text-md font-semibold text-gray-200 mb-2",children:"Mineralgehalt (mg/L)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-4",children:[e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-300",children:"Ca:"}),e.jsx("input",{type:"number",step:"1",value:l.ca,onChange:c=>o(l.id,"ca",c.target.value),className:"w-full px-2 py-1 border rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-slate-100 bg-white text-gray-900 mt-1 block"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-300",children:"Mg:"}),e.jsx("input",{type:"number",step:"1",value:l.mg,onChange:c=>o(l.id,"mg",c.target.value),className:"w-full px-2 py-1 border rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-slate-100 bg-white text-gray-900 mt-1 block"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-300",children:"Na:"}),e.jsx("input",{type:"number",step:"1",value:l.na,onChange:c=>o(l.id,"na",c.target.value),className:"w-full px-2 py-1 border rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-slate-100 bg-white text-gray-900 mt-1 block"})]}),re.filter(c=>!["n","p","k","ca","mg","na"].includes(c.key)).map(c=>e.jsxs("label",{className:"block",children:[e.jsxs("span",{className:"text-gray-300",children:[c.label?c.label.split(" ")[0]:c.key.toUpperCase(),":"]}),e.jsx("input",{type:"number",step:"0.001",value:l[c.key],onChange:u=>o(l.id,c.key,u.target.value),className:"w-full px-2 py-1 border rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-slate-100 bg-white text-gray-900 mt-1 block"})]},c.key)),e.jsxs("label",{className:"block",children:[e.jsxs("span",{className:"text-gray-300",children:["Volumen (",i.unit==="liter"?"L":"Gal","):"]}),e.jsx("input",{type:"number",step:"1",value:l.volume,onChange:c=>o(l.id,"volume",c.target.value),className:"w-full px-2 py-1 border rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-slate-100 bg-white text-gray-900 mt-1 block"})]})]})]},l.id)),e.jsxs("div",{className:"flex justify-center space-x-2 mt-4",children:[e.jsx(M,{onClick:()=>n("tapWater"),variant:"primary","aria-label":"Leitungswasser hinzufügen",title:"Leitungswasser hinzufügen",children:"Leitungswasser hinzufügen"}),e.jsx(M,{onClick:()=>n("roWater"),variant:"primary","aria-label":"Osmosewasser hinzufügen",title:"Osmosewasser hinzufügen",children:"Osmosewasser hinzufügen"}),e.jsx(M,{onClick:()=>n("custom"),variant:"primary","aria-label":"Eigene Quelle hinzufügen",title:"Eigene Quelle hinzufügen",children:"Eigene Quelle hinzufügen"})]}),s&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-700 rounded-md text-white",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Zusammenfassung der Wasserwerte"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-600",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Quelle"}),e.jsx("th",{className:"py-2 px-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Volumen (L)"}),e.jsx("th",{className:"py-2 px-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"pH"}),e.jsx("th",{className:"py-2 px-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"EC (mS/cm)"}),re.map(l=>e.jsxs("th",{className:"py-2 px-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:[l.label?l.label.split(" ")[0]:l.key.toUpperCase()," (",l.key.toUpperCase(),")"]},l.key))]})}),e.jsxs("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:[t.map(l=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-4 whitespace-nowrap text-sm text-gray-200",children:l.name}),e.jsx("td",{className:"py-2 px-4 whitespace-nowrap text-sm text-gray-200",children:l.volume.toFixed(1)}),e.jsx("td",{className:"py-2 px-4 whitespace-nowrap text-sm text-gray-200",children:l.ph.toFixed(2)}),e.jsx("td",{className:"py-2 px-4 whitespace-nowrap text-sm text-gray-200",children:l.ec.toFixed(2)}),re.map(c=>e.jsx("td",{className:"py-2 px-4 whitespace-nowrap text-sm text-gray-200",children:(l[c.key]||0).toFixed(1)},c.key))]},l.id)),e.jsxs("tr",{className:"bg-gray-600 font-bold",children:[e.jsx("td",{className:"py-2 px-4 whitespace-nowrap text-sm text-white",children:"Gemischt"}),e.jsxs("td",{className:"py-2 px-4 whitespace-nowrap text-sm text-white",children:[s.totalVolume.toFixed(1)," ",i.unit==="liter"?"L":"Gal"]}),e.jsx("td",{className:"py-2 px-4 whitespace-nowrap text-sm text-white",children:s.ph.toFixed(2)}),e.jsx("td",{className:"py-2 px-4 whitespace-nowrap text-sm text-white",children:s.ec.toFixed(2)}),re.map(l=>e.jsx("td",{className:"py-2 px-4 whitespace-nowrap text-sm text-white",children:(s[l.key]||0).toFixed(1)},l.key))]})]})]})})]})]})});Ut.displayName="WaterInput";const on=kt("bg-white rounded-xl border border-stone-200 overflow-hidden",{variants:{variant:{default:"shadow-sm",elevated:"shadow-lg hover:shadow-xl transition-shadow duration-300",outlined:"border-2 shadow-none",ghost:"border-none shadow-none bg-transparent"},padding:{none:"",sm:"p-4",md:"p-6",lg:"p-8"}},defaultVariants:{variant:"default",padding:"md"}}),q=U.forwardRef(({className:t,variant:s,padding:n,...r},a)=>e.jsx("div",{ref:a,className:$(on({variant:s,padding:n,className:t})),...r}));q.displayName="Card";const Z=U.forwardRef(({className:t,...s},n)=>e.jsx("div",{ref:n,className:$("px-6 py-4 bg-stone-50 border-b border-stone-200",t),...s}));Z.displayName="CardHeader";const X=U.forwardRef(({className:t,...s},n)=>e.jsx("h3",{ref:n,className:$("text-lg font-semibold text-stone-900 leading-tight",t),...s}));X.displayName="CardTitle";const ln=U.forwardRef(({className:t,...s},n)=>e.jsx("p",{ref:n,className:$("text-sm text-stone-600 mt-1",t),...s}));ln.displayName="CardDescription";const Y=U.forwardRef(({className:t,...s},n)=>e.jsx("div",{ref:n,className:$("px-6 py-5",t),...s}));Y.displayName="CardContent";const cn=U.forwardRef(({className:t,...s},n)=>e.jsx("div",{ref:n,className:$("px-6 py-4 bg-stone-50 border-t border-stone-200",t),...s}));cn.displayName="CardFooter";const Ae={ca:0,mg:0,s:0,na:0,cl:0,no3:0,so4:0,po4:0,baseEC:0},dn=[],Pe=[{key:"n",label:"N (Stickstoff)",unit:"ppm"},{key:"p",label:"P (Phosphor)",unit:"ppm"},{key:"k",label:"K (Kalium)",unit:"ppm"},{key:"ec",label:"EC",unit:"mS/cm"}],mn=({NUTRIENT_FIELDS:t,GROWTH_STAGES:s,WATER_TYPES:n,fertilizerDatabase:r,onAnalysisUpdate:a,mixedWater:i})=>{var se,te,W,B,L,j;const{addToast:o}=be(),{settings:l}=qe(),[c,u]=p.useState(()=>{const w=l.waterAmount?Number(l.waterAmount):10;return Math.max(.1,w)}),[h,x]=p.useState(l.growthPhase||Object.keys(s)[0]),[d,g]=p.useState(l.waterType||Object.keys(n)[0]),[f,b]=p.useState(Ae),[y,A]=p.useState(dn),S={};Pe.forEach(w=>{S[w.key]=0});const[I,R]=p.useState({nutrients:S,contributions:{},stage:s[h]});p.useEffect(()=>{const w=Gt({waterVolume:c,growthStage:h,waterType:d,selectedFertilizers:y,fertilizerDatabase:r||{},customWaterProfile:f,NUTRIENT_FIELDS:t,GROWTH_STAGES:s,WATER_TYPES:n,mixedWater:i}),T={};Pe.forEach(E=>{var D;T[E.key]=((D=w.nutrients)==null?void 0:D[E.key])??0}),R({...w,nutrients:T}),a&&a({NUTRIENT_FIELDS:t,GROWTH_STAGES:s,WATER_TYPES:n,fertilizerDatabase:r,selectedFertilizers:y,waterVolume:c,growthStage:h,waterType:d,customWaterProfile:f,results:w,mixedWater:i})},[c,h,d,f,y,r,t,s,n,i]),p.useEffect(()=>{A(w=>w.filter(T=>r[T.id]))},[r]);const m=w=>{if(!w||y.find(E=>E.id===w))return;const T=r[w];A(E=>[...E,{id:w,amount:(T==null?void 0:T.type)==="powder"?.1:1,active:!0}])},v=w=>{A(T=>T.filter(E=>E.id!==w))},z=(w,T)=>{const E=parseFloat(T);A(D=>D.map(O=>O.id===w?{...O,amount:isNaN(E)||E<0?0:E}:O))},k=w=>{A(T=>T.map(E=>E.id===w?{...E,active:!E.active}:E))},F=()=>{try{const w=JSON.parse(localStorage.getItem("nutricalc_custom_fertilizers")||"[]"),T={selectedFertilizers:y,waterVolume:c,growthStage:h,waterType:d,customWaterProfile:f,customFertilizers:w},E=new Blob([JSON.stringify(T,null,2)],{type:"application/json"}),D=URL.createObjectURL(E),O=document.createElement("a");O.href=D,O.download="nutricalc-setup.json",document.body.appendChild(O),O.click(),document.body.removeChild(O),URL.revokeObjectURL(D),o("Setup exportiert!","success")}catch{o("Fehler beim Export!","error")}},_=w=>{const T=w.target.files[0];if(!T)return;const E=new FileReader;E.onload=D=>{try{const O=JSON.parse(D.target.result);if(!O||typeof O!="object")throw new Error;A(Array.isArray(O.selectedFertilizers)?O.selectedFertilizers:[]),u(Number(O.waterVolume)||10),x(O.growthStage||Object.keys(s)[0]),g(O.waterType||Object.keys(n)[0]),b(typeof O.customWaterProfile=="object"?O.customWaterProfile:Ae),Array.isArray(O.customFertilizers)&&(localStorage.setItem("nutricalc_custom_fertilizers",JSON.stringify(O.customFertilizers)),window.dispatchEvent&&window.dispatchEvent(new StorageEvent("storage",{key:"nutricalc_custom_fertilizers"}))),o("Setup importiert!","success")}catch{o("Ungültige Datei!","error")}},E.readAsText(T)},K=()=>{let w=[...y],T=!1;h.includes("veg")?(w=w.map(E=>E.id==="hesi_tnt"?{...E,amount:5,active:!0}:E.id==="ta_calmg"?{...E,amount:2.5,active:!0}:E),T=!0):h.includes("flower")&&(w=w.map(E=>E.id==="hesi_bloom"?{...E,amount:6,active:!0}:E),T=!0),T?(A(w),o("Empfohlene Dosierung geladen!","info")):o("Keine Empfehlung für diese Phase.","warning")},ee=()=>{window.confirm("Alle Daten (eigene Dünger, Wasserprofil, Auswahl) wirklich löschen?")&&(A([]),b(Ae),localStorage.removeItem("nutricalc_custom_fertilizers"),o("Alle Daten wurden zurückgesetzt.","info"))};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[e.jsxs(q,{variant:"elevated",children:[e.jsx(Z,{children:e.jsx(X,{children:"Grundeinstellungen"})}),e.jsxs(Y,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-stone-700 mb-2",htmlFor:"waterVolume",children:["Wassermenge (",l.unit==="liter"?"Liter":"Gallonen",")"]}),e.jsx("input",{id:"waterVolume",type:"number",min:"0.1",step:"0.1",value:c,onChange:w=>u(Math.max(.1,Number(w.target.value))),className:"w-full px-4 py-2.5 bg-white border border-stone-300 rounded-lg text-stone-900 placeholder-stone-400 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors",placeholder:"z.B. 10","aria-label":"Wassermenge"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",htmlFor:"growthStage",children:"Wachstumsphase"}),e.jsx("select",{id:"growthStage",value:h,onChange:w=>x(w.target.value),className:"w-full px-4 py-2.5 bg-white border border-stone-300 rounded-lg text-stone-900 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors","aria-label":"Wachstumsphase",children:Object.entries(s).map(([w,T])=>e.jsx("option",{value:w,children:T.name},w))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",htmlFor:"waterType",children:"Wassertyp"}),e.jsx("select",{id:"waterType",value:d,onChange:w=>g(w.target.value),className:"w-full px-4 py-2.5 bg-white border border-stone-300 rounded-lg text-stone-900 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors","aria-label":"Wassertyp",children:Object.entries(n).map(([w,T])=>e.jsx("option",{value:w,children:T.name},w))})]}),d==="custom"&&e.jsxs("div",{className:"mt-6 p-4 bg-stone-50 rounded-lg border border-stone-200",children:[e.jsx("h3",{className:"text-sm font-semibold text-stone-700 mb-3",children:"Eigenes Wasserprofil"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Object.keys(Ae).map(w=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-stone-600 mb-1",htmlFor:w,children:w.toUpperCase()}),e.jsx("input",{type:"number",name:w,value:f[w],onChange:T=>b(E=>({...E,[w]:parseFloat(T.target.value)||0})),className:"w-full px-3 py-2 bg-white border border-stone-300 rounded-md text-stone-900 text-xs focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors",min:"0",step:"0.01","aria-label":w.toUpperCase()})]},w))})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 pt-4 border-t border-stone-200",children:[e.jsx(M,{variant:"secondary",size:"sm",onClick:K,children:"Empfohlene Dosierung laden"}),e.jsx(M,{variant:"outline",size:"sm",onClick:F,children:"Daten exportieren"}),e.jsx(M,{variant:"outline",size:"sm",onClick:()=>{var w;return(w=document.getElementById("importFile"))==null?void 0:w.click()},children:"Daten importieren"}),e.jsx(M,{variant:"danger",size:"sm",onClick:ee,children:"Alle Daten löschen"})]}),e.jsx("input",{id:"importFile",type:"file",accept:".json",onChange:_,className:"hidden"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ut,{}),i&&e.jsxs(q,{variant:"elevated",children:[e.jsx(Z,{children:e.jsx(X,{children:"Gemischtes Wasser Ergebnis"})}),e.jsxs(Y,{children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-emerald-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-700",children:((se=i.ph)==null?void 0:se.toFixed(2))??"N/A"}),e.jsx("div",{className:"text-sm text-stone-600",children:"pH"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:((te=i.ec)==null?void 0:te.toFixed(2))??"N/A"}),e.jsx("div",{className:"text-sm text-stone-600",children:"EC (mS/cm)"})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-700",children:((W=i.totalVolume)==null?void 0:W.toFixed(1))??"N/A"}),e.jsx("div",{className:"text-sm text-stone-600",children:"Volumen (L)"})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-3 text-sm",children:[e.jsxs("div",{children:["Ca: ",e.jsxs("span",{className:"font-medium",children:[((B=i.ca)==null?void 0:B.toFixed(1))??"N/A"," mg/L"]})]}),e.jsxs("div",{children:["Mg: ",e.jsxs("span",{className:"font-medium",children:[((L=i.mg)==null?void 0:L.toFixed(1))??"N/A"," mg/L"]})]}),e.jsxs("div",{children:["Na: ",e.jsxs("span",{className:"font-medium",children:[((j=i.na)==null?void 0:j.toFixed(1))??"N/A"," mg/L"]})]})]})]})]}),e.jsxs(q,{variant:"elevated",children:[e.jsx(Z,{children:e.jsx(X,{children:"Dünger & Dosierung"})}),e.jsx(Y,{padding:"none",children:e.jsx(Ht,{selectedFertilizers:y,fertilizerDatabase:r,waterVolume:c,addFertilizer:m,removeFertilizer:v,updateFertilizerAmount:z,toggleFertilizer:k})})]})]})]}),I&&I.nutrients&&e.jsxs(q,{variant:"elevated",children:[e.jsx(Z,{children:e.jsx(X,{children:"Berechnete Hauptwerte"})}),e.jsx(Y,{children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:Pe.map(w=>{var T,E,D;return e.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-stone-50 to-stone-100 rounded-lg border border-stone-200",children:[e.jsx("div",{className:"text-xs font-medium text-stone-600 mb-1",children:w.label}),e.jsx("div",{className:"text-2xl font-bold text-emerald-700",children:((T=I==null?void 0:I.nutrients)==null?void 0:T[w.key])!==void 0&&((E=I.nutrients)==null?void 0:E[w.key])!==null&&!isNaN((D=I.nutrients)==null?void 0:D[w.key])?I.nutrients[w.key].toFixed(2):"0.00"}),e.jsx("div",{className:"text-xs text-stone-500",children:w.unit})]},w.key)})})})]})]})},Ee={name:"",type:"liquid",unit:"ml",composition:{n:"",p:"",k:""},concentration:"",description:""},un=t=>`custom_${t.replace(/\s+/g,"_").toLowerCase()}_${Date.now()}`,hn=({refreshFertilizerDatabase:t})=>{const[s,n]=p.useState([]),[r,a]=p.useState(Ee),[i,o]=p.useState(null),{addToast:l}=be();p.useEffect(()=>{const d=localStorage.getItem(ge);d&&n(JSON.parse(d))},[]),p.useEffect(()=>{localStorage.setItem(ge,JSON.stringify(s)),t&&t()},[s,t]);const c=d=>{const{name:g,value:f}=d.target;["n","p","k"].includes(g)?a({...r,composition:{...r.composition,[g]:f}}):a({...r,[g]:f})},u=d=>{d.preventDefault();const g={...r,composition:Object.fromEntries(Object.entries(r.composition).map(([f,b])=>[f.toLowerCase(),b]))};if(i!==null)n(s.map(f=>f.id===i?{...g,id:i}:f)),o(null),l("Dünger erfolgreich bearbeitet!","success");else{const f=un(r.name);n([...s,{...g,id:f}]),l("Dünger hinzugefügt!","success")}a(Ee)},h=d=>{const g=s.find(f=>f.id===d);g&&(a({name:g.name,type:g.type,unit:g.unit,composition:{n:g.composition.n||"",p:g.composition.p||"",k:g.composition.k||""},concentration:g.concentration||"",description:g.description||""}),o(d))},x=d=>{n(s.filter(g=>g.id!==d)),i===d&&(a(Ee),o(null)),l("Dünger gelöscht!","info")};return e.jsxs("div",{className:"max-w-xl mx-auto p-4 bg-white dark:bg-slate-800 rounded-lg shadow space-y-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800 dark:text-slate-100 mb-2",children:"Dünger verwalten"}),e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{name:"name",value:r.name,onChange:c,placeholder:"Name",className:"flex-1 px-2 py-1 border rounded-md dark:bg-slate-700 dark:text-slate-100",required:!0}),e.jsxs("select",{name:"type",value:r.type,onChange:c,className:"px-2 py-1 border rounded-md dark:bg-slate-700 dark:text-slate-100",children:[e.jsx("option",{value:"liquid",children:"Flüssig"}),e.jsx("option",{value:"powder",children:"Pulver"})]}),e.jsxs("select",{name:"unit",value:r.unit,onChange:c,className:"px-2 py-1 border rounded-md dark:bg-slate-700 dark:text-slate-100",children:[e.jsx("option",{value:"ml",children:"ml"}),e.jsx("option",{value:"g",children:"g"}),e.jsx("option",{value:"%",children:"%"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{name:"n",value:r.composition.n,onChange:c,placeholder:"N (%)",type:"number",min:"0",step:"0.01",className:"w-1/3 px-2 py-1 border rounded-md dark:bg-slate-700 dark:text-slate-100",required:!0}),e.jsx("input",{name:"p",value:r.composition.p,onChange:c,placeholder:"P (%)",type:"number",min:"0",step:"0.01",className:"w-1/3 px-2 py-1 border rounded-md dark:bg-slate-700 dark:text-slate-100",required:!0}),e.jsx("input",{name:"k",value:r.composition.k,onChange:c,placeholder:"K (%)",type:"number",min:"0",step:"0.01",className:"w-1/3 px-2 py-1 border rounded-md dark:bg-slate-700 dark:text-slate-100",required:!0})]}),e.jsx("input",{name:"concentration",value:r.concentration,onChange:c,placeholder:"Konzentration (g/L oder %)",type:"number",min:"0",step:"0.01",className:"w-full px-2 py-1 border rounded-md dark:bg-slate-700 dark:text-slate-100",required:!0}),e.jsx("input",{name:"description",value:r.description,onChange:c,placeholder:"Beschreibung (optional)",className:"w-full px-2 py-1 border rounded-md dark:bg-slate-700 dark:text-slate-100"}),e.jsx(M,{type:"submit",variant:"primary","aria-label":i!==null?"Dünger speichern":"Dünger hinzufügen",title:i!==null?"Dünger speichern":"Dünger hinzufügen",children:i!==null?"Speichern":"Hinzufügen"}),i!==null&&e.jsx(M,{type:"button",onClick:()=>{a(Ee),o(null)},variant:"secondary",className:"ml-2","aria-label":"Bearbeitung abbrechen",title:"Bearbeitung abbrechen",children:"Abbrechen"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Eigene Dünger"}),e.jsxs("ul",{className:"space-y-2",children:[s.length===0&&e.jsx("li",{className:"text-slate-500",children:"Noch keine Dünger hinzugefügt."}),s.map(d=>e.jsxs("li",{className:"flex items-center gap-2 p-2 bg-slate-100 dark:bg-slate-700 rounded",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-medium",children:[d.name," ",e.jsxs("span",{className:"text-xs text-slate-500",children:["(",d.type,")"]})]}),e.jsxs("div",{className:"text-xs",children:["N: ",d.composition.n,"% , P: ",d.composition.p,"% , K: ",d.composition.k,"% | Konzentration: ",d.concentration]})]}),e.jsx(M,{onClick:()=>h(d.id),variant:"secondary","aria-label":`Dünger ${d.name} bearbeiten`,title:`Dünger ${d.name} bearbeiten`,className:"text-xs",children:"Bearbeiten"}),e.jsx(M,{onClick:()=>x(d.id),variant:"danger","aria-label":`Dünger ${d.name} löschen`,title:`Dünger ${d.name} löschen`,className:"text-xs",children:"Löschen"})]},d.id))]})]})]})},Vt=(t,s)=>!s||!Array.isArray(s)||s.length!==2?"unknown":t>=s[0]&&t<=s[1]?"optimal":"suboptimal",gn=t=>{switch(t){case"optimal":return"bg-green-100 dark:bg-green-800/30 text-green-800 dark:text-green-200";case"suboptimal":return"bg-yellow-100 dark:bg-yellow-800/30 text-yellow-800 dark:text-yellow-200";default:return"bg-slate-100 dark:bg-slate-800/30 text-slate-800 dark:text-slate-200"}},Be=(t,s)=>{if(!s||!Array.isArray(s)||s.length!==2||s[1]===0)return 0;const n=s[1]*1.2;return Math.min(t/n*100,100)},pn=({NUTRIENT_FIELDS:t,GROWTH_STAGES:s,_WATER_TYPES:n,_fertilizerDatabase:r,_selectedFertilizers:a,_waterVolume:i,growthStage:o,_waterType:l,_customWaterProfile:c,results:u})=>{const h=s[o]||{},x=t.filter(g=>{var y;const f=(y=u.nutrients)==null?void 0:y[g.key],b=h[g.key];return f!==void 0&&b&&(f<b[0]||f>b[1])}),d=[];return x.length>0?d.push("Passe die Dosierung deiner Dünger an, um die Nährstoffe in den optimalen Bereich zu bringen."):d.push("Alle Hauptnährstoffe sind im optimalen Bereich!"),e.jsxs("div",{className:"max-w-3xl mx-auto p-4 bg-white dark:bg-slate-800 rounded-lg shadow space-y-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800 dark:text-slate-100 mb-2",children:"Nährstoff-Analyse"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-1 text-left",children:"Nährstoff"}),e.jsx("th",{className:"px-2 py-1 text-left",children:"Wert"}),e.jsx("th",{className:"px-2 py-1 text-left",children:"Optimalbereich"}),e.jsx("th",{className:"px-2 py-1 text-left",children:"Status"})]})}),e.jsx("tbody",{children:t.map(g=>{var A;const f=(A=u.nutrients)==null?void 0:A[g.key],b=h[g.key],y=Vt(f,b);return e.jsxs("tr",{className:gn(y),children:[e.jsx("td",{className:"px-2 py-1 font-medium",children:g.label}),e.jsx("td",{className:"px-2 py-1",children:f!==void 0?f:"-"}),e.jsx("td",{className:"px-2 py-1",children:b?`${b[0]} - ${b[1]}`:"-"}),e.jsx("td",{className:"px-2 py-1",children:y==="optimal"?"Optimal":y==="suboptimal"?"Achtung":"Unbekannt"})]},g.key)})})]})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"font-semibold mb-1",children:"Warnungen"}),x.length===0?e.jsx("div",{className:"text-green-700 dark:text-green-300",children:"Keine Warnungen. Alle Werte sind im optimalen Bereich."}):e.jsx("ul",{className:"list-disc pl-5 text-yellow-700 dark:text-yellow-300",children:x.map(g=>e.jsxs("li",{children:[g.label,": Wert außerhalb des Optimalbereichs!"]},g.key))})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"font-semibold mb-1",children:"Optimierungstipps"}),e.jsx("ul",{className:"list-disc pl-5 text-blue-700 dark:text-blue-300",children:d.map((g,f)=>e.jsx("li",{children:g},f))})]})]})},fn=[{key:"fe",label:"Eisen (Fe)",optimal:[.5,2.5]},{key:"mn",label:"Mangan (Mn)",optimal:[.2,1]},{key:"zn",label:"Zink (Zn)",optimal:[.05,.2]},{key:"cu",label:"Kupfer (Cu)",optimal:[.01,.05]},{key:"b",label:"Bor (B)",optimal:[.02,.1]},{key:"mo",label:"Molybdän (Mo)",optimal:[.005,.02]}],xn=[{key:"s",label:"Schwefel (S)",optimal:[30,70]}];function it(t,s){if(!s||!Array.isArray(s)||s.length!==2)return"neutral";const[n,r]=s;return t<n*.8?"low":t>r*1.2?"high":t>=n&&t<=r?"optimal":"moderate"}function ot(t){switch(t){case"low":return"text-blue-700 bg-blue-100 dark:text-blue-300 dark:bg-blue-700/30 border border-blue-200 dark:border-blue-600";case"high":return"text-red-700 bg-red-100 dark:text-red-300 dark:bg-red-700/30 border border-red-200 dark:border-red-600";case"optimal":return"text-green-700 bg-green-100 dark:text-green-300 dark:bg-green-700/30 border border-green-200 dark:border-green-600";case"moderate":return"text-yellow-700 bg-yellow-100 dark:text-yellow-300 dark:bg-yellow-600/30 border border-yellow-200 dark:border-yellow-500";default:return"text-slate-600 bg-slate-100 dark:text-slate-400 dark:bg-slate-700/50 border border-slate-200 dark:border-slate-600"}}const bn=({results:t})=>e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-md font-semibold text-slate-700 dark:text-slate-200",children:"Mikronährstoffe (ppm)"}),e.jsx("div",{className:"space-y-1.5 bg-slate-100 dark:bg-slate-900/50 p-3 rounded-lg border border-slate-200 dark:border-slate-700",children:fn.map(s=>{var a;const n=((a=t==null?void 0:t.nutrients)==null?void 0:a[s.key])??0,r=it(n,s.optimal);return e.jsxs("div",{className:`flex justify-between items-center p-1.5 rounded-md text-xs ${ot(r)}`,children:[e.jsxs("span",{children:[s.label,":"]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:"font-medium",children:[n.toFixed(3)," ppm"]}),e.jsxs("div",{className:"text-[0.65rem] opacity-70",children:["(",s.optimal[0],"-",s.optimal[1],")"]})]})]},s.key)})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-md font-semibold text-slate-700 dark:text-slate-200",children:"Weitere Makro-/Sekundärnährstoffe (ppm)"}),e.jsx("div",{className:"space-y-1.5 bg-slate-100 dark:bg-slate-900/50 p-3 rounded-lg border border-slate-200 dark:border-slate-700",children:xn.map(s=>{var a;const n=((a=t==null?void 0:t.nutrients)==null?void 0:a[s.key])??0,r=it(n,s.optimal);return e.jsxs("div",{className:`flex justify-between items-center p-1.5 rounded-md text-xs ${ot(r)}`,children:[e.jsxs("span",{children:[s.label,":"]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:"font-medium",children:[n.toFixed(1)," ppm"]}),e.jsxs("div",{className:"text-[0.65rem] opacity-70",children:["(",s.optimal[0],"-",s.optimal[1],")"]})]})]},s.key)})}),e.jsxs("div",{className:"bg-yellow-100 dark:bg-yellow-700/30 p-3 rounded-lg border border-yellow-300 dark:border-yellow-600 mt-3",children:[e.jsx("h3",{className:"font-medium text-yellow-800 dark:text-yellow-200 mb-1.5 text-sm",children:"Nährstoff-Hinweise"}),e.jsxs("ul",{className:"text-xs text-yellow-700 dark:text-yellow-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Weniger ist oft mehr, besonders bei Mikronährstoffen."}),e.jsx("li",{children:"Bei Mangelerscheinungen zuerst pH-Wert und Wurzelgesundheit prüfen."}),e.jsx("li",{children:"Fe-Mangel: junge Blätter hellgrün/gelb, Adern bleiben grün."}),e.jsx("li",{children:"Ca-Mangel: junge Blätter verformt, Blütenendfäule."})]})]})]})]}),yn=()=>e.jsxs("div",{className:"max-w-lg mx-auto p-4 bg-white dark:bg-slate-800 rounded-lg shadow space-y-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800 dark:text-slate-100 mb-4",children:"Referenzen & Hilfe"}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-md font-semibold text-slate-700 dark:text-slate-200 mb-2",children:"Wichtige Links & Studien"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-slate-600 dark:text-slate-300",children:[e.jsx("li",{children:e.jsx("a",{href:"#",className:"text-blue-600 hover:underline",children:"Link zu Nährstoffbedarf von Pflanzen (Beispielstudie)"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"text-blue-600 hover:underline",children:"Artikel über Wasserqualität und EC-Werte"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"text-blue-600 hover:underline",children:"Ressourcen zur Düngerzusammensetzung"})})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-md font-semibold text-slate-700 dark:text-slate-200 mb-2",children:"Erklärungen zu Nährstoffen"}),e.jsxs("div",{className:"space-y-4 text-slate-600 dark:text-slate-300",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Stickstoff (N):"})," Essentiell für das vegetative Wachstum, Blattentwicklung und Photosynthese. Mangel zeigt sich oft in blassen, gelben Blättern."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phosphor (P):"})," Wichtig für Blüten- und Fruchtentwicklung, Wurzelwachstum und Energieübertragung. Ein Mangel kann zu verkümmertem Wachstum und dunklen Blättern führen."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Kalium (K):"})," Fördert die allgemeine Pflanzengesundheit, Wasseraufnahme und den Transport von Nährstoffen. Mangel kann zu gelben oder braunen Blatträndern führen."]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-md font-semibold text-slate-700 dark:text-slate-200 mb-2",children:"Häufig gestellte Fragen (FAQ)"}),e.jsxs("div",{className:"space-y-3 text-slate-600 dark:text-slate-300",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Q: Wie berechne ich die richtige Düngermenge?"}),e.jsx("p",{children:"A: Die App verwendet Ihre Eingaben zu Wasservolumen, Wachstumsphase und Wassertyp, um die optimale Düngermenge zu berechnen. Passen Sie die Mengen für jeden Dünger an, um die gewünschten Nährstoffwerte zu erreichen."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Q: Was bedeutet EC-Wert?"}),e.jsx("p",{children:"A: Der EC-Wert (elektrische Leitfähigkeit) misst die Gesamtkonzentration der gelösten Salze (Nährstoffe) im Wasser. Ein optimaler EC-Wert ist entscheidend für die Nährstoffaufnahme der Pflanzen."})]})]})]})]}),Ye="nutricalc_secure_data",qt="NutriCalc2024SecureKey";function vn(t,s){let n="";for(let r=0;r<t.length;r++){const a=t.charCodeAt(r),i=s.charCodeAt(r%s.length);n+=String.fromCharCode(a^i)}return btoa(n)}function wn(t,s){try{const n=atob(t);let r="";for(let a=0;a<n.length;a++){const i=n.charCodeAt(a),o=s.charCodeAt(a%s.length);r+=String.fromCharCode(i^o)}return r}catch{return""}}function Yt(t){try{const n={key:vn(t,qt),timestamp:Date.now(),version:"1.0"};localStorage.setItem(Ye,JSON.stringify(n))}catch{localStorage.setItem("nutricalc_gemini_api_key",t)}}function kn(){try{const t=localStorage.getItem(Ye);if(t){const n=JSON.parse(t);if(n.key&&n.version)return wn(n.key,qt)}const s=localStorage.getItem("nutricalc_gemini_api_key");return s?(Yt(s),localStorage.removeItem("nutricalc_gemini_api_key"),s):""}catch{return""}}function lt(){try{localStorage.removeItem(Ye),localStorage.removeItem("nutricalc_gemini_api_key")}catch{}}function ct(t){return!t||typeof t!="string"?!1:/^AIza[0-9A-Za-z-_]{35}$/.test(t)}const Jt=()=>{const[t,s]=p.useState(""),[n,r]=p.useState(!1);return p.useEffect(()=>{const o=kn();o&&(s(o),r(ct(o)))},[]),{apiKey:t,isValid:n,updateApiKey:o=>{const l=o.trim(),c=ct(l);s(l),r(c),l?Yt(l):lt()},removeApiKey:()=>{s(""),r(!1),lt()}}},jn="modulepreload",Nn=function(t){return"/NutriCalc/"+t},dt={},Cn=function(s,n,r){if(!n||n.length===0)return s();const a=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=Nn(i),i in dt)return;dt[i]=!0;const o=i.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!r)for(let h=a.length-1;h>=0;h--){const x=a[h];if(x.href===i&&(!o||x.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${l}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":jn,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((h,x)=>{u.addEventListener("load",h),u.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>s()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},Sn=({language:t,onSettingsChange:s,className:n})=>{var I,R;const[r,a]=p.useState({apiKey:"",provider:"gemini",enableProactiveAlerts:!0,enableFloatingWidget:!0,conversationHistory:!0,dataPrivacy:!0}),[i,o]=p.useState(!1),[l,c]=p.useState(!1),[u,h]=p.useState("idle"),{addToast:x}=be();p.useEffect(()=>{const m=localStorage.getItem("ai-assistant-settings");if(m)try{const v=JSON.parse(m);a(z=>({...z,...v}))}catch{console.warn("Failed to parse saved AI settings")}},[]),p.useEffect(()=>{localStorage.setItem("ai-assistant-settings",JSON.stringify(r)),s==null||s(r)},[r,s]);const d=(m,v)=>{a(z=>({...z,[m]:v}))},g=async()=>{if(!r.apiKey.trim()){x(t==="de"?"Bitte geben Sie einen API-Schlüssel ein":"Please enter an API key","error");return}c(!0),h("idle");try{let m=!1;switch(r.provider){case"gemini":m=await f(r.apiKey);break;case"openai":m=await b(r.apiKey);break;case"claude":m=await y(r.apiKey);break}m?(h("success"),x(t==="de"?"Verbindung erfolgreich!":"Connection successful!","success")):(h("error"),x(t==="de"?"Verbindung fehlgeschlagen":"Connection failed","error"))}catch{h("error"),x(t==="de"?"Verbindungstest fehlgeschlagen":"Connection test failed","error")}finally{c(!1)}},f=async m=>{try{const v=(await Cn(()=>Promise.resolve().then(()=>Jn),void 0)).default,z=new v(m);return!0}catch(v){return console.error("Gemini connection test failed:",v),!1}},b=async m=>{try{return(await fetch("https://api.openai.com/v1/models",{headers:{Authorization:`Bearer ${m}`,"Content-Type":"application/json"}})).ok}catch(v){return console.error("OpenAI connection test failed:",v),!1}},y=async m=>{try{return(await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"x-api-key":m,"Content-Type":"application/json","anthropic-version":"2023-06-01"},body:JSON.stringify({model:"claude-3-sonnet-20240229",max_tokens:10,messages:[{role:"user",content:"Test"}]})})).ok}catch(v){return console.error("Claude connection test failed:",v),!1}},A=()=>{window.confirm(t==="de"?"Möchten Sie wirklich alle AI-Daten löschen? Dies kann nicht rückgängig gemacht werden.":"Are you sure you want to clear all AI data? This cannot be undone.")&&(localStorage.removeItem("ai-assistant-settings"),localStorage.removeItem("ai-conversation-history"),a({apiKey:"",provider:"gemini",enableProactiveAlerts:!0,enableFloatingWidget:!0,conversationHistory:!0,dataPrivacy:!0}),x(t==="de"?"Alle AI-Daten wurden gelöscht":"All AI data has been cleared","success"))},S=[{id:"gemini",name:"Google Gemini",description:t==="de"?"Googles fortschrittliches AI-Modell":"Google's advanced AI model",setupUrl:"https://makersuite.google.com/app/apikey"},{id:"openai",name:"OpenAI GPT-4",description:t==="de"?"OpenAIs leistungsstarkes Sprachmodell":"OpenAI's powerful language model",setupUrl:"https://platform.openai.com/api-keys"},{id:"claude",name:"Anthropic Claude",description:t==="de"?"Anthropics sicheres AI-System":"Anthropic's safe AI system",setupUrl:"https://console.anthropic.com/"}];return e.jsxs("div",{className:$("space-y-6",n),children:[e.jsxs(q,{children:[e.jsx(Z,{children:e.jsx(X,{children:t==="de"?"AI-Provider Konfiguration":"AI Provider Configuration"})}),e.jsxs(Y,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:t==="de"?"AI-Provider auswählen":"Select AI Provider"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:S.map(m=>e.jsx("div",{className:$("p-3 border-2 rounded-lg cursor-pointer transition-all",r.provider===m.id?"border-emerald-500 bg-emerald-50":"border-stone-200 hover:border-stone-300"),onClick:()=>d("provider",m.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:m.name}),e.jsx("p",{className:"text-sm text-stone-600",children:m.description})]}),e.jsx("div",{className:"flex items-center space-x-2",children:r.provider===m.id&&e.jsx("span",{className:"text-emerald-600",children:"✓"})})]})},m.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:t==="de"?"API-Schlüssel":"API Key"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:i?"text":"password",value:r.apiKey,onChange:m=>d("apiKey",m.target.value),placeholder:t==="de"?"Geben Sie Ihren API-Schlüssel ein":"Enter your API key",className:"w-full px-3 py-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500"}),e.jsx("button",{type:"button",onClick:()=>o(!i),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-stone-400 hover:text-stone-600",children:i?"🙈":"👁️"})]}),e.jsxs(M,{onClick:g,disabled:l||!r.apiKey.trim(),variant:"outline",className:$(u==="success"&&"border-green-500 text-green-700",u==="error"&&"border-red-500 text-red-700"),children:[l?"⏳":u==="success"?"✅":u==="error"?"❌":"🔍",t==="de"?"Testen":"Test"]})]}),e.jsxs("p",{className:"text-xs text-stone-600 mt-1",children:[t==="de"?"API-Schlüssel erhalten:":"Get API key:"," ",e.jsx("a",{href:(I=S.find(m=>m.id===r.provider))==null?void 0:I.setupUrl,target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline",children:(R=S.find(m=>m.id===r.provider))==null?void 0:R.name})]})]})]})]}),e.jsxs(q,{children:[e.jsx(Z,{children:e.jsx(X,{children:t==="de"?"Funktionen":"Features"})}),e.jsxs(Y,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:t==="de"?"Proaktive Warnungen":"Proactive Alerts"}),e.jsx("p",{className:"text-sm text-stone-600",children:t==="de"?"Automatische Benachrichtigungen bei kritischen Problemen":"Automatic notifications for critical issues"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.enableProactiveAlerts,onChange:m=>d("enableProactiveAlerts",m.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-stone-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-emerald-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-stone-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-600"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:t==="de"?"Schwebendes Chat-Widget":"Floating Chat Widget"}),e.jsx("p",{className:"text-sm text-stone-600",children:t==="de"?"Chat-Button in der unteren rechten Ecke anzeigen":"Show chat button in bottom right corner"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.enableFloatingWidget,onChange:m=>d("enableFloatingWidget",m.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-stone-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-emerald-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-stone-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-600"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:t==="de"?"Gesprächsverlauf speichern":"Save Conversation History"}),e.jsx("p",{className:"text-sm text-stone-600",children:t==="de"?"Chat-Verlauf lokal speichern für besseren Kontext":"Save chat history locally for better context"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.conversationHistory,onChange:m=>d("conversationHistory",m.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-stone-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-emerald-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-stone-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-600"})]})]})]})]}),e.jsxs(q,{children:[e.jsx(Z,{children:e.jsx(X,{children:t==="de"?"Datenschutz & Daten":"Privacy & Data"})}),e.jsxs(Y,{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:t==="de"?"Datenschutz-Hinweis":"Privacy Notice"}),e.jsx("p",{className:"text-sm text-blue-800",children:t==="de"?"Ihre Daten werden nur lokal gespeichert und nur für AI-Anfragen an den gewählten Provider gesendet. Keine Daten werden an Dritte weitergegeben.":"Your data is only stored locally and only sent to the selected AI provider for requests. No data is shared with third parties."})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-stone-200",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-700",children:t==="de"?"Alle AI-Daten löschen":"Clear All AI Data"}),e.jsx("p",{className:"text-sm text-stone-600",children:t==="de"?"Löscht alle gespeicherten Einstellungen und Gesprächsverläufe":"Removes all saved settings and conversation history"})]}),e.jsx(M,{onClick:A,variant:"destructive",children:t==="de"?"Löschen":"Clear"})]})]})]})]})},An=()=>{const{apiKey:t,updateApiKey:s,removeApiKey:n}=Jt(),[r,a]=U.useState(t||""),{settings:i,updateSetting:o}=qe(),{theme:l,toggleTheme:c}=St(),u=()=>{s(r.trim())},h=()=>{n(),a("")},x=b=>{o("unit",b.target.value)},d=b=>{o("waterAmount",b.target.value)},g=b=>{o("growthPhase",b.target.value)},f=b=>{o("waterType",b.target.value)};return e.jsxs("div",{className:"max-w-lg mx-auto p-4 bg-white dark:bg-slate-800 rounded-lg shadow space-y-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800 dark:text-slate-100 mb-4",children:"Einstellungen"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"apiKey",children:"Gemini API Key"}),e.jsx("input",{id:"apiKey",type:"text",value:r,onChange:b=>a(b.target.value),className:"w-full px-2 py-1 border rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-slate-100",placeholder:"API Key eingeben..."}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(M,{onClick:u,variant:"primary","aria-label":"API Key speichern",title:"API Key speichern",children:"Speichern"}),e.jsx(M,{onClick:h,variant:"danger","aria-label":"API Key entfernen",title:"API Key entfernen",children:"Entfernen"})]}),e.jsx("div",{className:"text-xs text-slate-500 mt-2",children:"Dein API Key wird lokal im Browser gespeichert."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"unit",children:"Einheit für Wassermenge"}),e.jsxs("select",{id:"unit",value:i.unit,onChange:x,className:"w-full px-2 py-1 border rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-slate-100",children:[e.jsx("option",{value:"liter",children:"Liter"}),e.jsx("option",{value:"gallon",children:"Gallonen"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"defaultWaterAmount",children:"Standard-Wassermenge (ml/oz)"}),e.jsx("input",{id:"defaultWaterAmount",type:"number",value:i.waterAmount,onChange:d,className:"w-full px-2 py-1 border rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-slate-100",placeholder:"Standard-Wassermenge eingeben..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"defaultGrowthPhase",children:"Standard-Wachstumsphase"}),e.jsxs("select",{id:"defaultGrowthPhase",value:i.growthPhase,onChange:g,className:"w-full px-2 py-1 border rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-slate-100",children:[e.jsx("option",{value:"",children:"Auswählen..."}),Object.entries(oe).map(([b,y])=>e.jsx("option",{value:b,children:y.name},b))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"defaultWaterType",children:"Standard-Wassertyp"}),e.jsxs("select",{id:"defaultWaterType",value:i.waterType,onChange:f,className:"w-full px-2 py-1 border rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-slate-100",children:[e.jsx("option",{value:"",children:"Auswählen..."}),Object.entries(he).map(([b,y])=>e.jsx("option",{value:b,children:y.name},b))]})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Dark Mode"}),e.jsx(M,{onClick:c,variant:"secondary","aria-label":"Dark Mode umschalten",title:"Dark Mode umschalten",children:l==="dark"?"Deaktivieren":"Aktivieren"}),e.jsxs("span",{className:"text-xs text-slate-500",children:["Aktuell: ",l==="dark"?"Dunkel":"Hell"]})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-100 mb-4",children:"AI-Assistent"}),e.jsx(Sn,{language:"de",onSettingsChange:b=>{}})]})]})},En={setup:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M4 6h16M4 12h16M4 18h16"})}),details:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 8v4l3 3"})]}),analysis:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[e.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),e.jsx("path",{d:"M8 16v-4M12 16v-8M16 16v-2"})]}),fertilizer:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[e.jsx("rect",{x:"6",y:"3",width:"12",height:"18",rx:"2"}),e.jsx("path",{d:"M9 7h6"})]}),"ai-assistant":e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423L16.5 15.75l.394 1.183a2.25 2.25 0 001.423 1.423L19.5 18.75l-1.183.394a2.25 2.25 0 00-1.423 1.423z"})}),settings:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"12",cy:"12",r:"3"}),e.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33h.09a1.65 1.65 0 0 0 1-1.51V3a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.51h.09a1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82v.09a1.65 1.65 0 0 0 1.51 1H21a2 2 0 1 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),references:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),e.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})]})};function mt(t){return En[t]||e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("circle",{cx:"12",cy:"12",r:"10"})})}const In=({activeTab:t,setActiveTab:s})=>{const n=p.useRef([]),r=(a,i)=>{var o,l,c,u;if(["ArrowRight","ArrowDown"].includes(a.key)){a.preventDefault();const h=(i+1)%V.length;(o=n.current[h])==null||o.focus()}else if(["ArrowLeft","ArrowUp"].includes(a.key)){a.preventDefault();const h=(i-1+V.length)%V.length;(l=n.current[h])==null||l.focus()}else a.key==="Home"?(a.preventDefault(),(c=n.current[0])==null||c.focus()):a.key==="End"&&(a.preventDefault(),(u=n.current[V.length-1])==null||u.focus())};return e.jsxs("nav",{"aria-label":"App Navigation",className:"",children:[e.jsxs("div",{className:"hidden md:flex flex-col w-64 min-h-full bg-white/95 backdrop-blur-sm border-r border-stone-200 py-6 px-4 space-y-1 fixed top-0 left-0 z-20 shadow-sm",children:[e.jsx("div",{className:"mb-8 px-2",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"N"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-stone-900",children:"NutriCalc"}),e.jsx("p",{className:"text-xs text-stone-500",children:"Nutrient Calculator"})]})]})}),e.jsx("div",{role:"tablist","aria-orientation":"vertical",className:"flex flex-col gap-1",children:V.map((a,i)=>e.jsxs("button",{ref:o=>n.current[i]=o,role:"tab","aria-selected":t===a.id,tabIndex:t===a.id?0:-1,className:`flex items-center gap-3 px-4 py-3 rounded-xl font-medium transition-all duration-200 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 ${t===a.id?"bg-emerald-50 text-emerald-700 shadow-sm ring-1 ring-emerald-200":"text-stone-600 hover:text-stone-900 hover:bg-stone-50"}`,onClick:()=>s(a.id),onKeyDown:o=>r(o,i),"aria-label":a.label,children:[mt(a.id),e.jsx("span",{children:a.label})]},a.id))})]}),e.jsx("div",{className:"fixed md:hidden bottom-0 left-0 right-0 z-30 bg-white/95 backdrop-blur-sm border-t border-stone-200 flex justify-around py-2 shadow-lg",children:e.jsx("div",{role:"tablist","aria-orientation":"horizontal",className:"flex w-full max-w-md mx-auto",children:V.map((a,i)=>e.jsxs("button",{ref:o=>n.current[i]=o,role:"tab","aria-selected":t===a.id,tabIndex:t===a.id?0:-1,className:`flex flex-col items-center flex-1 px-2 py-2 text-xs font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 ${t===a.id?"text-emerald-600 bg-emerald-50":"text-stone-600 hover:text-stone-900 hover:bg-stone-50"}`,onClick:()=>s(a.id),onKeyDown:o=>r(o,i),"aria-label":a.label,children:[mt(a.id),e.jsx("span",{className:"mt-1 leading-tight",children:a.label})]},a.id))})})]})};class De extends p.Component{constructor(s){super(s),this.state={hasError:!1}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,n){console.error("ErrorBoundary caught an error:",s,n),this.setState({error:s,errorInfo:n})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen bg-gray-100 dark:bg-slate-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-slate-800 rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-8 w-8 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Etwas ist schiefgelaufen"})})]}),e.jsx("div",{className:"mb-4",children:e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Ein unerwarteter Fehler ist aufgetreten. Bitte laden Sie die Seite neu oder versuchen Sie es später erneut."})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>window.location.reload(),className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200",children:"Seite neu laden"}),e.jsx("button",{onClick:()=>this.setState({hasError:!1,error:void 0,errorInfo:void 0}),className:"flex-1 bg-gray-300 hover:bg-gray-400 dark:bg-gray-600 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-200 font-medium py-2 px-4 rounded-md transition-colors duration-200",children:"Erneut versuchen"})]}),!1]})}):this.props.children}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ut;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT"})(ut||(ut={}));var ht;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(ht||(ht={}));var gt;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(gt||(gt={}));var pt;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER"})(pt||(pt={}));var _e;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.OTHER="OTHER"})(_e||(_e={}));var ft;(function(t){t.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",t.RETRIEVAL_QUERY="RETRIEVAL_QUERY",t.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",t.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",t.CLASSIFICATION="CLASSIFICATION",t.CLUSTERING="CLUSTERING"})(ft||(ft={}));/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe extends Error{constructor(s){super(`[GoogleGenerativeAI Error]: ${s}`)}}class xt extends fe{constructor(s,n){super(s),this.response=n}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _n="https://generativelanguage.googleapis.com",zn="v1",Tn="0.1.3",Mn="genai-js";var le;(function(t){t.GENERATE_CONTENT="generateContent",t.STREAM_GENERATE_CONTENT="streamGenerateContent",t.COUNT_TOKENS="countTokens",t.EMBED_CONTENT="embedContent",t.BATCH_EMBED_CONTENTS="batchEmbedContents"})(le||(le={}));class ye{constructor(s,n,r,a){this.model=s,this.task=n,this.apiKey=r,this.stream=a}toString(){let s=`${_n}/${zn}/models/${this.model}:${this.task}`;return this.stream&&(s+="?alt=sse"),s}}function Rn(){return`${Mn}/${Tn}`}async function ve(t,s){let n;try{if(n=await fetch(t.toString(),{method:"POST",headers:{"Content-Type":"application/json","x-goog-api-client":Rn(),"x-goog-api-key":t.apiKey},body:s}),!n.ok){let r="";try{const a=await n.json();r=a.error.message,a.error.details&&(r+=` ${JSON.stringify(a.error.details)}`)}catch{}throw new Error(`[${n.status} ${n.statusText}] ${r}`)}}catch(r){const a=new fe(`Error fetching from ${t.toString()}: ${r.message}`);throw a.stack=r.stack,a}return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Je(t){return t.text=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),Qt(t.candidates[0]))throw new xt(`${ze(t)}`,t);return On(t)}else if(t.promptFeedback)throw new xt(`Text not available. ${ze(t)}`,t);return""},t}function On(t){var s,n,r,a;return!((a=(r=(n=(s=t.candidates)===null||s===void 0?void 0:s[0].content)===null||n===void 0?void 0:n.parts)===null||r===void 0?void 0:r[0])===null||a===void 0)&&a.text?t.candidates[0].content.parts[0].text:""}const Ln=[_e.RECITATION,_e.SAFETY];function Qt(t){return!!t.finishReason&&Ln.includes(t.finishReason)}function ze(t){var s,n,r;let a="";if((!t.candidates||t.candidates.length===0)&&t.promptFeedback)a+="Response was blocked",!((s=t.promptFeedback)===null||s===void 0)&&s.blockReason&&(a+=` due to ${t.promptFeedback.blockReason}`),!((n=t.promptFeedback)===null||n===void 0)&&n.blockReasonMessage&&(a+=`: ${t.promptFeedback.blockReasonMessage}`);else if(!((r=t.candidates)===null||r===void 0)&&r[0]){const i=t.candidates[0];Qt(i)&&(a+=`Candidate was blocked due to ${i.finishReason}`,i.finishMessage&&(a+=`: ${i.finishMessage}`))}return a}function xe(t){return this instanceof xe?(this.v=t,this):new xe(t)}function Pn(t,s,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,s||[]),a,i=[];return a={},o("next"),o("throw"),o("return"),a[Symbol.asyncIterator]=function(){return this},a;function o(d){r[d]&&(a[d]=function(g){return new Promise(function(f,b){i.push([d,g,f,b])>1||l(d,g)})})}function l(d,g){try{c(r[d](g))}catch(f){x(i[0][3],f)}}function c(d){d.value instanceof xe?Promise.resolve(d.value.v).then(u,h):x(i[0][2],d)}function u(d){l("next",d)}function h(d){l("throw",d)}function x(d,g){d(g),i.shift(),i.length&&l(i[0][0],i[0][1])}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bt=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function Bn(t){const s=t.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),n=$n(s),[r,a]=n.tee();return{stream:Fn(r),response:Dn(a)}}async function Dn(t){const s=[],n=t.getReader();for(;;){const{done:r,value:a}=await n.read();if(r)return Je(Wn(s));s.push(a)}}function Fn(t){return Pn(this,arguments,function*(){const n=t.getReader();for(;;){const{value:r,done:a}=yield xe(n.read());if(a)break;yield yield xe(Je(r))}})}function $n(t){const s=t.getReader();return new ReadableStream({start(r){let a="";return i();function i(){return s.read().then(({value:o,done:l})=>{if(l){if(a.trim()){r.error(new fe("Failed to parse stream"));return}r.close();return}a+=o;let c=a.match(bt),u;for(;c;){try{u=JSON.parse(c[1])}catch{r.error(new fe(`Error parsing JSON response: "${c[1]}"`));return}r.enqueue(u),a=a.substring(c[0].length),c=a.match(bt)}return i()})}}})}function Wn(t){const s=t[t.length-1],n={promptFeedback:s==null?void 0:s.promptFeedback};for(const r of t)if(r.candidates)for(const a of r.candidates){const i=a.index;if(n.candidates||(n.candidates=[]),n.candidates[i]||(n.candidates[i]={index:a.index}),n.candidates[i].citationMetadata=a.citationMetadata,n.candidates[i].finishReason=a.finishReason,n.candidates[i].finishMessage=a.finishMessage,n.candidates[i].safetyRatings=a.safetyRatings,a.content&&a.content.parts){n.candidates[i].content||(n.candidates[i].content={role:a.content.role||"user",parts:[{text:""}]});for(const o of a.content.parts)o.text&&(n.candidates[i].content.parts[0].text+=o.text)}}return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zt(t,s,n){const r=new ye(s,le.STREAM_GENERATE_CONTENT,t,!0),a=await ve(r,JSON.stringify(n));return Bn(a)}async function Xt(t,s,n){const r=new ye(s,le.GENERATE_CONTENT,t,!1),i=await(await ve(r,JSON.stringify(n))).json();return{response:Je(i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pe(t,s){let n=[];if(typeof t=="string")n=[{text:t}];else for(const r of t)typeof r=="string"?n.push({text:r}):n.push(r);return{role:s,parts:n}}function Fe(t){return t.contents?t:{contents:[pe(t,"user")]}}function Kn(t){return typeof t=="string"||Array.isArray(t)?{content:pe(t,"user")}:t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yt="SILENT_ERROR";class Gn{constructor(s,n,r){this.model=n,this.params=r,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=s,r!=null&&r.history&&(this._history=r.history.map(a=>{if(!a.role)throw new Error("Missing role for history item: "+JSON.stringify(a));return pe(a.parts,a.role)}))}async getHistory(){return await this._sendPromise,this._history}async sendMessage(s){var n,r;await this._sendPromise;const a=pe(s,"user"),i={safetySettings:(n=this.params)===null||n===void 0?void 0:n.safetySettings,generationConfig:(r=this.params)===null||r===void 0?void 0:r.generationConfig,contents:[...this._history,a]};let o;return this._sendPromise=this._sendPromise.then(()=>Xt(this._apiKey,this.model,i)).then(l=>{var c;if(l.response.candidates&&l.response.candidates.length>0){this._history.push(a);const u=Object.assign({parts:[],role:"model"},(c=l.response.candidates)===null||c===void 0?void 0:c[0].content);this._history.push(u)}else{const u=ze(l.response);u&&console.warn(`sendMessage() was unsuccessful. ${u}. Inspect response object for details.`)}o=l}),await this._sendPromise,o}async sendMessageStream(s){var n,r;await this._sendPromise;const a=pe(s,"user"),i={safetySettings:(n=this.params)===null||n===void 0?void 0:n.safetySettings,generationConfig:(r=this.params)===null||r===void 0?void 0:r.generationConfig,contents:[...this._history,a]},o=Zt(this._apiKey,this.model,i);return this._sendPromise=this._sendPromise.then(()=>o).catch(l=>{throw new Error(yt)}).then(l=>l.response).then(l=>{if(l.candidates&&l.candidates.length>0){this._history.push(a);const c=Object.assign({},l.candidates[0].content);c.role||(c.role="model"),this._history.push(c)}else{const c=ze(l);c&&console.warn(`sendMessageStream() was unsuccessful. ${c}. Inspect response object for details.`)}}).catch(l=>{l.message!==yt&&console.error(l)}),o}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hn(t,s,n){const r=new ye(s,le.COUNT_TOKENS,t,!1);return(await ve(r,JSON.stringify(Object.assign(Object.assign({},n),{model:s})))).json()}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Un(t,s,n){const r=new ye(s,le.EMBED_CONTENT,t,!1);return(await ve(r,JSON.stringify(n))).json()}async function Vn(t,s,n){const r=new ye(s,le.BATCH_EMBED_CONTENTS,t,!1),a=n.requests.map(o=>Object.assign(Object.assign({},o),{model:`models/${s}`}));return(await ve(r,JSON.stringify({requests:a}))).json()}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(s,n){var r;this.apiKey=s,n.model.startsWith("models/")?this.model=(r=n.model.split("models/"))===null||r===void 0?void 0:r[1]:this.model=n.model,this.generationConfig=n.generationConfig||{},this.safetySettings=n.safetySettings||[]}async generateContent(s){const n=Fe(s);return Xt(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings},n))}async generateContentStream(s){const n=Fe(s);return Zt(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings},n))}startChat(s){return new Gn(this.apiKey,this.model,s)}async countTokens(s){const n=Fe(s);return Hn(this.apiKey,this.model,n)}async embedContent(s){const n=Kn(s);return Un(this.apiKey,this.model,n)}async batchEmbedContents(s){return Vn(this.apiKey,this.model,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(s){this.apiKey=s}getGenerativeModel(s){if(!s.model)throw new fe("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new qn(this.apiKey,s)}}class es{constructor(){Q(this,"growthStages");Q(this,"nutrientDeficiencies");Q(this,"cultivationTips");Q(this,"commonProblems");this.initializeGrowthStages(),this.initializeNutrientDeficiencies(),this.initializeCultivationTips(),this.initializeCommonProblems()}initializeGrowthStages(){this.growthStages={seedling:{name:"Seedling",duration:"1-3 weeks",characteristics:["First true leaves developing","Delicate root system","Low nutrient requirements","High humidity needs"],optimalNutrients:{n:[50,100],p:[20,40],k:[40,80],ca:[100,150],mg:[30,50],ec:[.4,.8],ph:[5.8,6.2]},commonIssues:["Overwatering","Nutrient burn","Damping off","Light burn"],tips:["Use quarter-strength nutrients","Maintain high humidity (70-80%)","Gentle lighting (18-24 hours)","Keep soil slightly moist"],environmentalNeeds:{temperature:[20,25],humidity:[70,80],lightCycle:"18/6 or 24/0",ph:[5.8,6.2],ec:[.4,.8]}},"early-veg":{name:"Early Vegetative",duration:"3-6 weeks",characteristics:["Rapid leaf development","Strong root growth","Increased nutrient uptake","Node development"],optimalNutrients:{n:[100,150],p:[40,60],k:[80,120],ca:[150,200],mg:[50,70],ec:[.8,1.2],ph:[5.8,6.3]},commonIssues:["Nitrogen deficiency","Overfeeding","pH fluctuations","Pest emergence"],tips:["Increase nitrogen gradually","Monitor pH daily","Begin training techniques","Ensure good air circulation"],environmentalNeeds:{temperature:[22,26],humidity:[60,70],lightCycle:"18/6",ph:[5.8,6.3],ec:[.8,1.2]}},"late-veg":{name:"Late Vegetative",duration:"4-8 weeks",characteristics:["Vigorous growth","Pre-flower development","Maximum nutrient uptake","Training opportunities"],optimalNutrients:{n:[150,200],p:[60,80],k:[120,160],ca:[200,250],mg:[70,90],ec:[1.2,1.6],ph:[5.9,6.4]},commonIssues:["Nutrient lockout","Calcium deficiency","Light stress","Training damage"],tips:["Peak feeding time","Implement training methods","Monitor for pre-flowers","Prepare for flower transition"],environmentalNeeds:{temperature:[22,27],humidity:[55,65],lightCycle:"18/6",ph:[5.9,6.4],ec:[1.2,1.6]}},flowering:{name:"Flowering",duration:"8-12 weeks",characteristics:["Bud development","Reduced nitrogen needs","Increased P-K requirements","Trichome production"],optimalNutrients:{n:[80,120],p:[80,120],k:[160,220],ca:[200,250],mg:[70,90],ec:[1.4,1.8],ph:[6,6.5]},commonIssues:["Bud rot","Phosphorus deficiency","Calcium deficiency","Light burn on buds"],tips:["Reduce nitrogen gradually","Increase P-K ratios","Lower humidity","Monitor trichomes for harvest"],environmentalNeeds:{temperature:[20,25],humidity:[40,50],lightCycle:"12/12",ph:[6,6.5],ec:[1.4,1.8]}}}}initializeNutrientDeficiencies(){this.nutrientDeficiencies={nitrogen:{nutrient:"Nitrogen (N)",symptoms:["Yellowing of lower leaves","Slow growth","Pale green coloration","Premature leaf drop"],causes:["Insufficient nitrogen in nutrient solution","pH lockout (too high or low)","Root problems","Overwatering"],solutions:["Increase nitrogen concentration","Check and adjust pH (5.8-6.3)","Improve root health","Reduce watering frequency"],severity:"moderate",affectedStages:["early-veg","late-veg"]},phosphorus:{nutrient:"Phosphorus (P)",symptoms:["Dark green leaves with purple stems","Purple/red leaf discoloration","Slow flowering","Reduced bud development"],causes:["Low phosphorus levels","Cold temperatures","pH too high or low","Nutrient lockout"],solutions:["Increase phosphorus levels","Maintain optimal temperature","Adjust pH to 6.0-6.5","Flush and reset nutrients"],severity:"severe",affectedStages:["flowering"]},potassium:{nutrient:"Potassium (K)",symptoms:["Brown leaf edges (burn)","Yellow spots on leaves","Weak stems","Poor bud quality"],causes:["Insufficient potassium","High sodium levels","pH imbalance","Light burn stress"],solutions:["Increase potassium levels","Check water quality","Maintain proper pH","Reduce light intensity"],severity:"moderate",affectedStages:["late-veg","flowering"]},calcium:{nutrient:"Calcium (Ca)",symptoms:["Brown spots on leaves","Weak cell walls","Bud rot susceptibility","Stunted growth"],causes:["Low calcium levels","High humidity","Poor air circulation","Magnesium excess"],solutions:["Add calcium supplement","Improve ventilation","Balance Mg:Ca ratio","Monitor humidity levels"],severity:"severe",affectedStages:["late-veg","flowering"]},magnesium:{nutrient:"Magnesium (Mg)",symptoms:["Yellowing between leaf veins","Leaf curling","Reduced chlorophyll","Poor light absorption"],causes:["Low magnesium levels","High potassium levels","pH lockout","Cold temperatures"],solutions:["Add Epsom salt (MgSO4)","Balance K:Mg ratio","Adjust pH to optimal range","Maintain proper temperature"],severity:"moderate",affectedStages:["late-veg","flowering"]}}}initializeCultivationTips(){this.cultivationTips=[{category:"nutrients",title:"Start Low, Go Slow",description:"Begin with 25% of recommended nutrient strength and gradually increase based on plant response.",applicableStages:["seedling","early-veg"],difficulty:"beginner",language:"en"},{category:"nutrients",title:"Niedrig anfangen, langsam steigern",description:"Beginnen Sie mit 25% der empfohlenen Nährstoffstärke und erhöhen Sie diese schrittweise basierend auf der Pflanzenreaktion.",applicableStages:["seedling","early-veg"],difficulty:"beginner",language:"de"},{category:"environment",title:"VPD Management",description:"Maintain optimal Vapor Pressure Deficit (VPD) for maximum growth efficiency.",applicableStages:["late-veg","flowering"],difficulty:"expert",language:"en"},{category:"training",title:"LST Timing",description:"Begin Low Stress Training when plants have 4-6 nodes for optimal results.",applicableStages:["early-veg","late-veg"],difficulty:"intermediate",language:"en"},{category:"harvest",title:"Trichome Inspection",description:"Harvest when trichomes are 70% cloudy, 30% amber for balanced effects.",applicableStages:["flowering"],difficulty:"intermediate",language:"en"}]}initializeCommonProblems(){this.commonProblems={nutrient_burn:{symptoms:["Leaf tip burn","Dark green leaves","Clawing"],causes:["Overfeeding","High EC levels"],solutions:["Reduce nutrient concentration","Flush with pH water"]},ph_lockout:{symptoms:["Multiple deficiency symptoms","Stunted growth"],causes:["pH too high/low","Nutrient precipitation"],solutions:["Adjust pH to optimal range","Flush and reset"]},light_burn:{symptoms:["Bleached leaves","Crispy leaf edges"],causes:["Lights too close","Excessive intensity"],solutions:["Increase light distance","Reduce intensity"]}}}getGrowthStageInfo(s){return this.growthStages[s]||null}getNutrientDeficiencyInfo(s){return this.nutrientDeficiencies[s]||null}getCultivationTips(s,n,r="en"){return this.cultivationTips.filter(a=>!(r&&a.language!==r||s&&!a.applicableStages.includes(s)||n&&a.difficulty!==n))}diagnoseIssue(s){const n=[];return Object.values(this.nutrientDeficiencies).forEach(r=>{const a=s.filter(i=>r.symptoms.some(o=>o.toLowerCase().includes(i.toLowerCase())||i.toLowerCase().includes(o.toLowerCase()))).length;a>0&&n.push({type:"nutrient_deficiency",issue:r,confidence:a/s.length})}),Object.entries(this.commonProblems).forEach(([r,a])=>{const i=s.filter(o=>a.symptoms.some(l=>l.toLowerCase().includes(o.toLowerCase())||o.toLowerCase().includes(l.toLowerCase()))).length;i>0&&n.push({type:"common_problem",issue:{name:r,...a},confidence:i/s.length})}),n.sort((r,a)=>a.confidence-r.confidence)}getOptimalNutrients(s){const n=this.getGrowthStageInfo(s);return(n==null?void 0:n.optimalNutrients)||null}getEnvironmentalNeeds(s){const n=this.getGrowthStageInfo(s);return(n==null?void 0:n.environmentalNeeds)||null}}class ts{constructor(){Q(this,"knowledgeBase");this.knowledgeBase=new es}analyzeContext(s){const n=this.analyzeNutrients(s),r=this.analyzeGrowthStage(s),a=this.analyzeEnvironment(s),i=this.generateRecommendations(s,n,r),o=this.generateAlerts(s,n,a),l=this.calculateOverallConfidence(n,r,a);return{nutrientStatus:n,growthStageAnalysis:r,environmentalAssessment:a,recommendations:i,alerts:o,confidence:l}}analyzeNutrients(s){const n=this.knowledgeBase.getOptimalNutrients(s.growthStage);if(!n)return this.getDefaultNutrientStatus();const r={};let a=0,i=0;Object.entries(s.nutrients).forEach(([d,g])=>{const f=n[d];if(f){i++;const[b,y]=f,A=this.calculateDeviation(g,b,y);let S;g<b?S="low":g>y?S="high":(S="optimal",a++),r[d]={status:S,current:g,optimal:f,deviation:A}}});const o=a/i;let l;if(o>=.8)l="optimal";else if(o>=.6)l="suboptimal";else{const d=Object.values(r).filter(f=>f.status==="low").length,g=Object.values(r).filter(f=>f.status==="high").length;l=d>g?"deficient":"excessive"}const c=n.ec||[.8,1.6],u=n.ph||[5.8,6.3],h=this.getStatus(s.nutrients.ec,c[0],c[1]),x=this.getStatus(s.nutrients.ph,u[0],u[1]);return{overall:l,individual:r,ecStatus:h,phStatus:x}}analyzeGrowthStage(s){if(!this.knowledgeBase.getGrowthStageInfo(s.growthStage))return this.getDefaultGrowthStageAnalysis(s.growthStage);const r=s.growWeek||1,i={seedling:2,"early-veg":4,"late-veg":6,flowering:10}[s.growthStage]||4,o=Math.min(r/i,1),l=["seedling","early-veg","late-veg","flowering"],c=l.indexOf(s.growthStage),u=c<l.length-1?l[c+1]:void 0,x=this.analyzeNutrients(s).overall==="optimal",d=this.getTransitionRecommendations(s.growthStage,o,u);return{currentStage:s.growthStage,weekInStage:r,nextStage:u,stageProgress:o,stageOptimal:x,transitionRecommendations:d}}analyzeEnvironment(s){const n=this.knowledgeBase.getEnvironmentalNeeds(s.growthStage);if(!n||!s.environmentalData)return{temperature:"unknown",humidity:"unknown",lightCycle:"unknown",overallScore:.5};const{environmentalData:r}=s,{temperature:a,humidity:i}=n,o=r.temperature?this.getStatus(r.temperature,a[0],a[1]):"unknown",l=r.humidity?this.getStatus(r.humidity,i[0],i[1]):"unknown",c=r.lightCycle===n.lightCycle?"correct":r.lightCycle?"incorrect":"unknown",u=[o,l,c].map(x=>{switch(x){case"optimal":case"correct":return 1;case"low":case"high":case"incorrect":return .3;default:return .5}}),h=u.reduce((x,d)=>x+d,0)/u.length;return{temperature:o,humidity:l,lightCycle:c,overallScore:h}}generateRecommendations(s,n,r){const a=[];if(Object.entries(n.individual).forEach(([i,o])=>{if(o.status!=="optimal"){const l=Math.abs(o.deviation)>.5?"high":"medium",c=o.status==="low"?"increase":"decrease";a.push({type:"nutrient",priority:l,title:`${c.charAt(0).toUpperCase()+c.slice(1)} ${i.toUpperCase()}`,description:`Current ${i.toUpperCase()}: ${o.current}, Optimal: ${o.optimal[0]}-${o.optimal[1]}`,reasoning:`${i.toUpperCase()} levels are ${o.status} for ${s.growthStage} stage`,timeframe:l==="high"?"immediate":"within_day"})}}),r.stageProgress>.8&&r.nextStage&&a.push({type:"general",priority:"medium",title:`Prepare for ${r.nextStage}`,description:`Consider transitioning to ${r.nextStage} stage`,reasoning:`Current stage is ${Math.round(r.stageProgress*100)}% complete`,timeframe:"within_week"}),s.environmentalData){const i=this.knowledgeBase.getEnvironmentalNeeds(s.growthStage);i&&s.environmentalData.temperature&&(s.environmentalData.temperature<i.temperature[0]||s.environmentalData.temperature>i.temperature[1])&&a.push({type:"environmental",priority:"medium",title:"Adjust Temperature",description:`Optimal temperature for ${s.growthStage}: ${i.temperature[0]}-${i.temperature[1]}°C`,reasoning:`Current temperature (${s.environmentalData.temperature}°C) is outside optimal range`,timeframe:"immediate"})}return a.sort((i,o)=>{const l={critical:4,high:3,medium:2,low:1};return l[o.priority]-l[i.priority]})}generateAlerts(s,n,r){const a=[];if(Object.entries(n.individual).forEach(([i,o])=>{Math.abs(o.deviation)>.7&&a.push({type:"warning",severity:"high",title:`Critical ${i.toUpperCase()} ${o.status==="low"?"Deficiency":"Excess"}`,message:`${i.toUpperCase()} levels are critically ${o.status}. Immediate action required.`,dismissible:!1})}),n.phStatus!=="optimal"){const i=Math.abs(s.nutrients.ph-6)>1?"critical":"medium";a.push({type:"warning",severity:i,title:"pH Out of Range",message:`pH (${s.nutrients.ph}) is ${n.phStatus}. This can cause nutrient lockout.`,dismissible:i!=="critical"})}return r.overallScore<.4&&a.push({type:"warning",severity:"medium",title:"Environmental Conditions Suboptimal",message:"Multiple environmental parameters are outside optimal ranges.",dismissible:!0}),a.sort((i,o)=>{const l={critical:4,high:3,medium:2,low:1};return l[o.severity]-l[i.severity]})}calculateOverallConfidence(s,n,r){let a=.7;const i=Object.keys(s.individual).length;return i>=5&&(a+=.1),i>=7&&(a+=.1),r.overallScore>.5&&(a+=.05),r.overallScore===.5&&(a-=.05),n.stageOptimal&&(a+=.05),Math.max(.3,Math.min(.95,a))}calculateDeviation(s,n,r){return s<n?(n-s)/n:s>r?(s-r)/r:0}getStatus(s,n,r){return s<n?"low":s>r?"high":"optimal"}getDefaultNutrientStatus(){return{overall:"suboptimal",individual:{},ecStatus:"optimal",phStatus:"optimal"}}getDefaultGrowthStageAnalysis(s){return{currentStage:s,weekInStage:1,stageProgress:.1,stageOptimal:!1}}getTransitionRecommendations(s,n,r){if(n<.7||!r)return[];const a={"seedling-early-veg":["Gradually increase nutrient strength","Begin monitoring for pest emergence","Prepare for increased water uptake"],"early-veg-late-veg":["Increase nitrogen levels","Consider training techniques","Monitor for pre-flower signs"],"late-veg-flowering":["Switch to 12/12 light cycle","Reduce nitrogen, increase P-K","Lower humidity to prevent mold"]},i=`${s}-${r}`;return a[i]||[]}}class ss{constructor(s){Q(this,"geminiAI");Q(this,"conversationHistory",new Map);Q(this,"knowledgeBase");Q(this,"contextEngine");this.geminiAI=new Yn(s),this.knowledgeBase=new es,this.contextEngine=new ts}async sendMessage(s,n,r="default"){try{const a=this.conversationHistory.get(r)||[],i={id:this.generateId(),role:"user",content:s,timestamp:Date.now(),context:n};a.push(i);const o=await this.generateResponse(s,n,a),l={id:this.generateId(),role:"assistant",content:o.message,timestamp:Date.now(),context:n,metadata:{confidence:o.confidence,suggestions:o.suggestions,actions:o.actions}};return a.push(l),this.conversationHistory.set(r,a.slice(-20)),o}catch(a){return console.error("AI Assistant Error:",a),this.getFallbackResponse(n)}}async generateResponse(s,n,r){const a=this.buildPrompt(s,n,r),l=(await this.geminiAI.getGenerativeModel({model:"gemini-pro"}).generateContent(a)).response.text();return this.parseAIResponse(l,n)}buildPrompt(s,n,r){const a=this.getSystemPrompt(n),i=this.buildContextPrompt(n),o=this.buildHistoryPrompt(r);return`${a}

${i}

${o}

User Question: ${s}

Please provide a helpful, accurate response in ${n.language==="de"?"German":"English"}.`}getSystemPrompt(s){const n=s.language==="de"?"Du bist ein erfahrener Cannabis-Anbau-Experte und Nährstoff-Spezialist. Du hilfst Nutzern bei allen Aspekten des Cannabis-Anbaus, von der Keimung bis zur Ernte.":"You are an expert cannabis cultivation specialist and nutrient expert. You help users with all aspects of cannabis growing, from germination to harvest.",r={beginner:s.language==="de"?"Erkläre Konzepte einfach und vermeide zu viel Fachjargon.":"Explain concepts simply and avoid too much technical jargon.",intermediate:s.language==="de"?"Gib detaillierte Erklärungen mit praktischen Tipps.":"Provide detailed explanations with practical tips.",expert:s.language==="de"?"Verwende Fachterminologie und gib präzise, technische Antworten.":"Use technical terminology and provide precise, technical answers."};return`${n} ${r[s.userLevel]}

Your expertise includes:
- Nutrient management and deficiency diagnosis
- Growth stage optimization
- Environmental control
- Pest and disease management
- Harvest timing and techniques
- Strain-specific guidance

Always provide actionable advice and explain the reasoning behind your recommendations.`}buildContextPrompt(s){const n=Object.entries(s.nutrients).map(([r,a])=>`${r.toUpperCase()}: ${a}`).join(", ");return`Current Cultivation Context:
- Growth Stage: ${s.growthStage}
- Water Volume: ${s.waterVolume}L
- Water Type: ${s.waterType}
- Current Nutrients: ${n}
- User Level: ${s.userLevel}
- Language: ${s.language}
${s.growWeek?`- Grow Week: ${s.growWeek}`:""}
${s.strainType?`- Strain Type: ${s.strainType}`:""}
${s.environmentalData?`- Environmental: ${JSON.stringify(s.environmentalData)}`:""}`}buildHistoryPrompt(s){return s.length===0?"":`Recent Conversation:
${s.slice(-6).map(a=>`${a.role}: ${a.content}`).join(`
`)}
`}parseAIResponse(s,n){const r=this.calculateConfidence(s),a=this.extractSuggestions(s),i=this.extractActions(s,n),o=this.extractWarnings(s),l=this.generateFollowUpQuestions(s,n);return{message:s,confidence:r,suggestions:a,actions:i,warnings:o,followUpQuestions:l}}calculateConfidence(s){let n=.7;return(s.includes("recommend")||s.includes("suggest"))&&(n+=.1),(s.includes("optimal")||s.includes("ideal"))&&(n+=.1),(s.includes("experience")||s.includes("typically"))&&(n+=.05),(s.includes("might")||s.includes("could"))&&(n-=.1),(s.includes("uncertain")||s.includes("depends"))&&(n-=.15),Math.max(.3,Math.min(.95,n))}extractSuggestions(s){const n=[],r=s.match(/(?:^\d+\.|^[-*])\s*(.+)$/gm);r&&n.push(...r.map(i=>i.replace(/^(?:\d+\.|[-*])\s*/,"")));const a=s.match(/(?:I recommend|I suggest|Consider|Try)\s+([^.!?]+)/gi);return a&&n.push(...a.map(i=>i.replace(/^(?:I recommend|I suggest|Consider|Try)\s+/i,""))),n.slice(0,5)}extractActions(s,n){const r=[];return s.toLowerCase().includes("adjust")&&s.toLowerCase().includes("nutrient")&&r.push({type:"adjust_nutrients",description:"Adjust nutrient levels based on recommendation",parameters:{context:n},priority:"medium"}),s.toLowerCase().includes("ph")&&(s.toLowerCase().includes("lower")||s.toLowerCase().includes("raise"))&&r.push({type:"change_ph",description:"Adjust pH levels",parameters:{context:n},priority:"high"}),r}extractWarnings(s){const n=[];return[/(?:warning|caution|careful|avoid|dangerous?|critical|urgent)/gi,/(?:too high|too low|excessive|deficient|toxic)/gi].forEach(a=>{const i=s.match(a);i&&i.length>0&&s.split(/[.!?]+/).forEach(l=>{a.test(l)&&n.push(l.trim())})}),[...new Set(n)].slice(0,3)}generateFollowUpQuestions(s,n){const r=[];return n.growthStage==="seedling"&&r.push(n.language==="de"?"Wie oft sollte ich in der Keimphase gießen?":"How often should I water during the seedling stage?"),n.nutrients.n>200&&r.push(n.language==="de"?"Sind meine Stickstoffwerte zu hoch?":"Are my nitrogen levels too high?"),n.userLevel==="beginner"&&r.push(n.language==="de"?"Was sind die häufigsten Anfängerfehler?":"What are the most common beginner mistakes?"),r.slice(0,3)}getFallbackResponse(s){return{message:s.language==="de"?"Entschuldigung, ich konnte Ihre Anfrage nicht verarbeiten. Bitte versuchen Sie es erneut oder stellen Sie eine spezifischere Frage.":"Sorry, I couldn't process your request. Please try again or ask a more specific question.",confidence:.1,suggestions:[],actions:[],warnings:[],followUpQuestions:[]}}generateId(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}getConversationHistory(s){return this.conversationHistory.get(s)||[]}clearConversationHistory(s){this.conversationHistory.delete(s)}exportConversation(s){const n=this.getConversationHistory(s);return JSON.stringify(n,null,2)}}const Jn=Object.freeze(Object.defineProperty({__proto__:null,default:ss},Symbol.toStringTag,{value:"Module"})),ns=(t={})=>{const{apiKey:s,sessionId:n="default",autoAnalyze:r=!0,enableProactiveAlerts:a=!0}=t,[i,o]=p.useState([]),[l,c]=p.useState(!1),[u,h]=p.useState(null),[x,d]=p.useState(!1),[g,f]=p.useState(!1),[b,y]=p.useState([]),[A,S]=p.useState(!0),[I,R]=p.useState(null),m=p.useRef(null),v=p.useRef(null),z=p.useRef(null),{addToast:k}=be();p.useEffect(()=>{if(A)try{const W=s||localStorage.getItem("gemini-api-key");if(!W){R("AI Assistant requires an API key. Please configure it in settings.");return}m.current=new ss(W),v.current=new ts;const B=m.current.getConversationHistory(n);o(B),R(null)}catch(W){R("Failed to initialize AI Assistant"),console.error("AI Assistant initialization error:",W)}},[s,n,A]);const F=p.useCallback(async(W,B)=>{if(!m.current||!A)throw new Error("AI Assistant not available");c(!0),R(null);try{const L=await m.current.sendMessage(W,B,n),j=m.current.getConversationHistory(n);return o(j),L.actions&&L.actions.length>0&&K(L.actions,B),L.warnings&&L.warnings.length>0&&L.warnings.forEach(w=>{k(w,"warning")}),f(!1),L}catch(L){const j=L instanceof Error?L.message:"Failed to send message";throw R(j),k(j,"error"),L}finally{c(!1)}},[n,A,k]),_=p.useCallback(async W=>{if(!v.current||!A)throw new Error("Context engine not available");try{const B=v.current.analyzeContext(W);return h(B),d(B.alerts.some(L=>L.severity==="high"||L.severity==="critical")),y(B.recommendations.filter(L=>L.priority==="high"||L.priority==="critical")),z.current=W,B}catch(B){const L=B instanceof Error?B.message:"Failed to analyze context";throw R(L),B}},[A]),K=p.useCallback((W,B)=>{W.forEach(L=>{switch(L.type){case"adjust_nutrients":k(B.language==="de"?"AI empfiehlt Nährstoff-Anpassungen":"AI recommends nutrient adjustments","info");break;case"change_ph":k(B.language==="de"?"pH-Anpassung empfohlen":"pH adjustment recommended",L.priority==="critical"?"warning":"info");break;case"environmental_change":k(B.language==="de"?"Umgebungsanpassung empfohlen":"Environmental adjustment recommended","info");break}})},[k]);p.useEffect(()=>{if(!a||!A||!z.current)return;const W=async()=>{try{const j=(await _(z.current)).alerts.filter(w=>w.severity==="critical"&&!w.dismissible);if(j.length>0&&m.current){const w=j.length===1?`Critical issue detected: ${j[0].message}`:`${j.length} critical issues detected. Please check your setup.`,T={id:`system-${Date.now()}`,role:"assistant",content:w,timestamp:Date.now(),context:z.current,metadata:{isProactive:!0,alerts:j}};o(E=>[...E,T]),f(!0)}}catch(L){console.warn("Proactive monitoring error:",L)}},B=window.setInterval(W,5*60*1e3);return()=>window.clearInterval(B)},[a,A,_]),p.useEffect(()=>{r&&z.current&&v.current&&A&&_(z.current).catch(console.warn)},[r,A,_]);const ee=p.useCallback(()=>{m.current&&(m.current.clearConversationHistory(n),o([]),f(!1))},[n]),se=p.useCallback(()=>m.current?m.current.exportConversation(n):"",[n]),te=p.useCallback(()=>{R(null)},[]);return p.useEffect(()=>()=>{},[]),{messages:i,isLoading:l,sendMessage:F,clearHistory:ee,exportConversation:se,contextAnalysis:u,analyzeContext:_,hasActiveAlerts:x,hasUnreadMessages:g,activeRecommendations:b,isEnabled:A,setEnabled:S,error:I,clearError:te}},Qn=({onClick:t,context:s,hasUnreadMessages:n=!1,hasActiveAlerts:r=!1,className:a})=>{const[i,o]=p.useState(!0),[l,c]=p.useState(!1),[u,h]=p.useState(!1);p.useEffect(()=>{let f=window.scrollY,b=!1;const y=()=>{const I=window.scrollY;if(Math.abs(I-f)<10){b=!1;return}o(I<=f||I<100),f=I>0?I:0,b=!1},A=()=>{b||(window.requestAnimationFrame(y),b=!0)},S=()=>A();return window.innerWidth<768&&window.addEventListener("scroll",S),()=>{window.innerWidth<768&&window.removeEventListener("scroll",S)}},[]),p.useEffect(()=>{if(r){c(!0);const f=setTimeout(()=>c(!1),3e3);return()=>clearTimeout(f)}},[r]),p.useEffect(()=>{if(!localStorage.getItem("ai-assistant-tooltip-seen")){h(!0);const b=setTimeout(()=>{h(!1),localStorage.setItem("ai-assistant-tooltip-seen","true")},5e3);return()=>clearTimeout(b)}},[]);const x=()=>r?"bg-red-500":n?"bg-orange-500":"bg-emerald-500",d=()=>r?"⚠️":n?"💬":"🤖",g=()=>r?s.language==="de"?"Wichtige Warnungen verfügbar!":"Important alerts available!":n?s.language==="de"?"Neue Nachrichten vom Assistenten":"New messages from assistant":s.language==="de"?"Fragen Sie den Anbau-Experten":"Ask the grow expert";return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:$("fixed bottom-4 right-4 z-40 transition-all duration-300","md:bottom-6 md:right-6",i?"translate-y-0 opacity-100":"translate-y-16 opacity-0",a),children:e.jsxs("div",{className:"relative",children:[u&&e.jsxs("div",{className:$("absolute bottom-full right-0 mb-2 px-3 py-2","bg-stone-900 text-white text-sm rounded-lg shadow-lg","whitespace-nowrap max-w-xs","animate-in slide-in-from-bottom-2 fade-in duration-300"),children:[g(),e.jsx("div",{className:"absolute top-full right-4 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-stone-900"})]}),e.jsx(M,{onClick:t,className:$("w-14 h-14 rounded-full shadow-lg hover:shadow-xl","transition-all duration-200 hover:scale-105","focus:outline-none focus:ring-4 focus:ring-emerald-500/20",x(),l&&"animate-pulse"),"aria-label":s.language==="de"?"AI-Anbau-Assistenten öffnen":"Open AI grow assistant",children:e.jsx("span",{className:"text-xl",children:d()})}),(n||r)&&e.jsx("div",{className:$("absolute -top-1 -right-1 w-5 h-5 rounded-full","flex items-center justify-center text-xs font-bold text-white",r?"bg-red-600":"bg-orange-600","animate-in zoom-in duration-200"),children:r?"!":"●"}),r&&e.jsx("div",{className:$("absolute inset-0 rounded-full","bg-red-500 opacity-20 animate-ping")})]})}),i&&(r||n)&&e.jsx("div",{className:$("fixed bottom-20 right-4 z-30","md:hidden","animate-in slide-in-from-bottom-2 fade-in duration-500"),children:e.jsx("div",{className:$("bg-white dark:bg-slate-800 rounded-lg shadow-lg border","px-3 py-2 text-sm max-w-xs"),children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-lg",children:d()}),e.jsx("span",{className:"text-stone-700 dark:text-slate-300",children:r?s.language==="de"?"Warnungen prüfen":"Check alerts":s.language==="de"?"Neue Tipps verfügbar":"New tips available"})]})})})]})},rs=({isOpen:t,onClose:s,onSendMessage:n,context:r,messages:a,isLoading:i,className:o})=>{const[l,c]=p.useState(""),[u,h]=p.useState(!1),x=p.useRef(null),d=p.useRef(null),g=()=>{var S;(S=x.current)==null||S.scrollIntoView({behavior:"smooth"})};p.useEffect(()=>{g()},[a]),p.useEffect(()=>{t&&d.current&&d.current.focus()},[t]);const f=async()=>{if(!l.trim()||i)return;const S=l.trim();c(""),h(!0);try{await n(S,r)}catch(I){console.error("Failed to send message:",I)}finally{h(!1)}},b=S=>{S.key==="Enter"&&!S.shiftKey&&(S.preventDefault(),f())},y=S=>S.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/`(.*?)`/g,'<code class="bg-stone-100 px-1 rounded text-sm">$1</code>').replace(/\n/g,"<br>"),A=()=>[r.language==="de"?"Wie sind meine aktuellen Nährstoffwerte?":"How are my current nutrient levels?",r.language==="de"?"Was sollte ich in dieser Wachstumsphase beachten?":"What should I focus on in this growth stage?",r.language==="de"?"Gibt es Probleme mit meiner Konfiguration?":"Are there any issues with my setup?",r.language==="de"?"Wann sollte ich zur nächsten Phase wechseln?":"When should I transition to the next stage?"].slice(0,2);return t?e.jsxs("div",{className:$("fixed inset-0 z-50 flex items-end justify-end p-4","md:inset-auto md:bottom-4 md:right-4 md:w-96 md:h-[600px]",o),children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 md:hidden",onClick:s}),e.jsxs(q,{className:$("w-full h-full max-h-[80vh] flex flex-col","md:w-96 md:h-[600px] md:max-h-none","bg-white dark:bg-slate-800 shadow-xl border-0 md:border"),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-stone-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"🤖"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-stone-900 dark:text-slate-100",children:r.language==="de"?"Anbau-Assistent":"Grow Assistant"}),e.jsx("p",{className:"text-xs text-stone-600 dark:text-slate-400",children:r.language==="de"?"Cannabis Experte":"Cannabis Expert"})]})]}),e.jsx(M,{variant:"ghost",size:"sm",onClick:s,className:"p-2","aria-label":r.language==="de"?"Chat schließen":"Close chat",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[a.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-100 dark:bg-emerald-900 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-2xl",children:"🌱"})}),e.jsx("h4",{className:"font-medium text-stone-900 dark:text-slate-100 mb-2",children:r.language==="de"?"Willkommen!":"Welcome!"}),e.jsx("p",{className:"text-sm text-stone-600 dark:text-slate-400 mb-4",children:r.language==="de"?"Ich bin Ihr persönlicher Cannabis-Anbau-Experte. Fragen Sie mich alles über Nährstoffe, Wachstumsphasen und Anbautechniken.":"I'm your personal cannabis cultivation expert. Ask me anything about nutrients, growth stages, and growing techniques."}),e.jsx("div",{className:"space-y-2",children:A().map((S,I)=>e.jsx(M,{variant:"outline",size:"sm",onClick:()=>c(S),className:"w-full text-left justify-start text-xs",children:S},I))})]}),a.map(S=>{var I;return e.jsx("div",{className:$("flex",S.role==="user"?"justify-end":"justify-start"),children:e.jsxs("div",{className:$("max-w-[80%] rounded-lg px-3 py-2 text-sm",S.role==="user"?"bg-emerald-600 text-white":"bg-stone-100 dark:bg-slate-700 text-stone-900 dark:text-slate-100"),children:[e.jsx("div",{dangerouslySetInnerHTML:{__html:y(S.content)}}),S.role==="assistant"&&((I=S.metadata)==null?void 0:I.suggestions)&&e.jsx("div",{className:"mt-2 space-y-1",children:S.metadata.suggestions.slice(0,2).map((R,m)=>e.jsxs(M,{variant:"ghost",size:"sm",onClick:()=>c(R),className:"w-full text-left justify-start text-xs p-1 h-auto",children:["💡 ",R]},m))})]})},S.id)}),(i||u)&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-stone-100 dark:bg-slate-700 rounded-lg px-3 py-2",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-stone-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-stone-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-stone-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})}),e.jsx("div",{ref:x})]}),e.jsxs("div",{className:"p-4 border-t border-stone-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{ref:d,type:"text",value:l,onChange:S=>c(S.target.value),onKeyPress:b,placeholder:r.language==="de"?"Stellen Sie eine Frage über Cannabis-Anbau...":"Ask a question about cannabis cultivation...",className:$("flex-1 px-3 py-2 text-sm border border-stone-300 dark:border-slate-600","rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500","bg-white dark:bg-slate-700 text-stone-900 dark:text-slate-100","placeholder-stone-500 dark:placeholder-slate-400"),disabled:i}),e.jsx(M,{onClick:f,disabled:!l.trim()||i,size:"sm",className:"px-3","aria-label":r.language==="de"?"Nachricht senden":"Send message",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]}),e.jsxs("div",{className:"mt-2 text-xs text-stone-500 dark:text-slate-400",children:[r.language==="de"?"Kontext:":"Context:"," ",r.growthStage," • ",r.waterVolume,"L • ",r.userLevel]})]})]})]}):null},Zn=({context:t,className:s})=>{const[n,r]=p.useState(!1),[a,i]=p.useState("overview"),{messages:o,isLoading:l,sendMessage:c,contextAnalysis:u,analyzeContext:h,hasActiveAlerts:x,activeRecommendations:d,isEnabled:g,setEnabled:f,error:b,clearError:y}=ns({autoAnalyze:!0,enableProactiveAlerts:!0});p.useEffect(()=>{g&&h(t).catch(console.warn)},[t,g,h]);const A=[{id:"overview",title:t.language==="de"?"Übersicht":"Overview",icon:"📊",description:t.language==="de"?"Aktuelle Analyse und Empfehlungen":"Current analysis and recommendations"},{id:"nutrients",title:t.language==="de"?"Nährstoffe":"Nutrients",icon:"🧪",description:t.language==="de"?"Nährstoff-Management und Optimierung":"Nutrient management and optimization"},{id:"growth",title:t.language==="de"?"Wachstum":"Growth",icon:"🌱",description:t.language==="de"?"Wachstumsphasen und Entwicklung":"Growth stages and development"},{id:"environment",title:t.language==="de"?"Umgebung":"Environment",icon:"🌡️",description:t.language==="de"?"Umgebungsbedingungen und Kontrolle":"Environmental conditions and control"},{id:"problems",title:t.language==="de"?"Probleme":"Problems",icon:"🔧",description:t.language==="de"?"Problemdiagnose und Lösungen":"Problem diagnosis and solutions"}],S=m=>({overview:[t.language==="de"?"Wie ist der aktuelle Zustand meiner Pflanzen?":"What's the current state of my plants?",t.language==="de"?"Gibt es wichtige Probleme zu beachten?":"Are there any important issues to address?",t.language==="de"?"Was sollte ich als nächstes tun?":"What should I do next?"],nutrients:[t.language==="de"?"Sind meine Nährstoffwerte optimal?":"Are my nutrient levels optimal?",t.language==="de"?"Wie kann ich meine Nährstofflösung verbessern?":"How can I improve my nutrient solution?",t.language==="de"?"Welche Dünger sollte ich verwenden?":"What fertilizers should I use?"],growth:[t.language==="de"?"Wann sollte ich zur nächsten Wachstumsphase wechseln?":"When should I transition to the next growth stage?",t.language==="de"?"Was ist typisch für diese Wachstumsphase?":"What's typical for this growth stage?",t.language==="de"?"Wie kann ich das Wachstum optimieren?":"How can I optimize growth?"],environment:[t.language==="de"?"Sind meine Umgebungsbedingungen richtig?":"Are my environmental conditions correct?",t.language==="de"?"Wie sollte ich Temperatur und Luftfeuchtigkeit einstellen?":"How should I set temperature and humidity?",t.language==="de"?"Was ist der optimale Lichtzyklus?":"What's the optimal light cycle?"],problems:[t.language==="de"?"Meine Blätter werden gelb, was ist das Problem?":"My leaves are turning yellow, what's the problem?",t.language==="de"?"Wie erkenne ich Nährstoffmängel?":"How do I identify nutrient deficiencies?",t.language==="de"?"Was kann ich gegen Schädlinge tun?":"What can I do about pests?"]})[m]||[],I=()=>e.jsxs("div",{className:"space-y-6",children:[u&&e.jsxs(q,{children:[e.jsx(Z,{children:e.jsxs(X,{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"📊"}),e.jsx("span",{children:t.language==="de"?"Aktuelle Analyse":"Current Analysis"})]})}),e.jsx(Y,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:$("p-4 rounded-lg border-2",u.nutrientStatus.overall==="optimal"?"border-green-200 bg-green-50":u.nutrientStatus.overall==="suboptimal"?"border-yellow-200 bg-yellow-50":"border-red-200 bg-red-50"),children:[e.jsx("h4",{className:"font-medium mb-2",children:t.language==="de"?"Nährstoffe":"Nutrients"}),e.jsx("p",{className:"text-sm capitalize",children:u.nutrientStatus.overall})]}),e.jsxs("div",{className:"p-4 rounded-lg border-2 border-blue-200 bg-blue-50",children:[e.jsx("h4",{className:"font-medium mb-2",children:t.language==="de"?"Wachstumsphase":"Growth Stage"}),e.jsx("p",{className:"text-sm",children:u.growthStageAnalysis.currentStage}),e.jsxs("p",{className:"text-xs text-stone-600 mt-1",children:[Math.round(u.growthStageAnalysis.stageProgress*100),"% ",t.language==="de"?"abgeschlossen":"complete"]})]}),e.jsxs("div",{className:$("p-4 rounded-lg border-2",u.environmentalAssessment.overallScore>.7?"border-green-200 bg-green-50":u.environmentalAssessment.overallScore>.4?"border-yellow-200 bg-yellow-50":"border-red-200 bg-red-50"),children:[e.jsx("h4",{className:"font-medium mb-2",children:t.language==="de"?"Umgebung":"Environment"}),e.jsxs("p",{className:"text-sm",children:[Math.round(u.environmentalAssessment.overallScore*100),"% ",(t.language==="de","optimal")]})]})]})})]}),x&&(u==null?void 0:u.alerts)&&e.jsxs(q,{children:[e.jsx(Z,{children:e.jsxs(X,{className:"flex items-center space-x-2 text-red-700",children:[e.jsx("span",{children:"⚠️"}),e.jsx("span",{children:t.language==="de"?"Aktive Warnungen":"Active Alerts"})]})}),e.jsx(Y,{children:e.jsx("div",{className:"space-y-3",children:u.alerts.filter(m=>m.severity==="high"||m.severity==="critical").map((m,v)=>e.jsxs("div",{className:$("p-3 rounded-lg border-l-4",m.severity==="critical"?"border-red-500 bg-red-50":"border-orange-500 bg-orange-50"),children:[e.jsx("h5",{className:"font-medium text-sm",children:m.title}),e.jsx("p",{className:"text-sm text-stone-600 mt-1",children:m.message})]},v))})})]}),d.length>0&&e.jsxs(q,{children:[e.jsx(Z,{children:e.jsxs(X,{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"💡"}),e.jsx("span",{children:t.language==="de"?"Empfehlungen":"Recommendations"})]})}),e.jsx(Y,{children:e.jsx("div",{className:"space-y-3",children:d.slice(0,3).map((m,v)=>e.jsxs("div",{className:"p-3 rounded-lg bg-emerald-50 border border-emerald-200",children:[e.jsx("h5",{className:"font-medium text-sm text-emerald-900",children:m.title}),e.jsx("p",{className:"text-sm text-emerald-700 mt-1",children:m.description}),e.jsx("p",{className:"text-xs text-emerald-600 mt-2",children:m.reasoning})]},v))})})]})]}),R=()=>{const m=S(a);return e.jsxs(q,{children:[e.jsx(Z,{children:e.jsx(X,{children:t.language==="de"?"Häufige Fragen":"Quick Questions"})}),e.jsx(Y,{children:e.jsx("div",{className:"grid grid-cols-1 gap-2",children:m.map((v,z)=>e.jsx(M,{variant:"outline",onClick:()=>{r(!0)},className:"text-left justify-start h-auto py-3 px-4",children:e.jsx("span",{className:"text-sm",children:v})},z))})})]})};return g?b?e.jsx("div",{className:$("p-6",s),children:e.jsx(q,{children:e.jsxs(Y,{className:"pt-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-2xl",children:"⚠️"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2 text-red-700",children:t.language==="de"?"AI-Assistent Fehler":"AI Assistant Error"}),e.jsx("p",{className:"text-stone-600 mb-4",children:b}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(M,{onClick:y,variant:"outline",children:t.language==="de"?"Erneut versuchen":"Try Again"}),e.jsx(M,{onClick:()=>f(!1),variant:"secondary",children:t.language==="de"?"Deaktivieren":"Disable"})]})]})})}):e.jsxs("div",{className:$("p-6 space-y-6",s),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-stone-900",children:t.language==="de"?"AI Anbau-Assistent":"AI Grow Assistant"}),e.jsx("p",{className:"text-stone-600",children:t.language==="de"?"Intelligente Beratung für optimalen Cannabis-Anbau":"Intelligent guidance for optimal cannabis cultivation"})]}),e.jsxs(M,{onClick:()=>r(!0),className:"flex items-center space-x-2",children:[e.jsx("span",{children:"💬"}),e.jsx("span",{children:t.language==="de"?"Chat öffnen":"Open Chat"})]})]}),e.jsx("div",{className:"flex space-x-1 bg-stone-100 rounded-lg p-1",children:A.map(m=>e.jsxs("button",{onClick:()=>i(m.id),className:$("flex-1 px-3 py-2 rounded-md text-sm font-medium transition-all",a===m.id?"bg-white text-emerald-700 shadow-sm":"text-stone-600 hover:text-stone-900"),children:[e.jsx("span",{className:"mr-2",children:m.icon}),m.title]},m.id))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:a==="overview"?I():R()}),e.jsx("div",{children:R()})]}),e.jsx(rs,{isOpen:n,onClose:()=>r(!1),onSendMessage:c,context:t,messages:o,isLoading:l})]}):e.jsx("div",{className:$("p-6",s),children:e.jsx(q,{children:e.jsxs(Y,{className:"pt-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-stone-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-2xl",children:"🤖"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:t.language==="de"?"AI-Assistent deaktiviert":"AI Assistant Disabled"}),e.jsx("p",{className:"text-stone-600 mb-4",children:t.language==="de"?"Aktivieren Sie den AI-Assistenten für intelligente Anbau-Beratung.":"Enable the AI Assistant for intelligent cultivation guidance."}),e.jsx(M,{onClick:()=>f(!0),children:t.language==="de"?"Aktivieren":"Enable"})]})})})},Xn=({nutrients:t,growthStage:s,waterType:n,waterVolume:r,selectedFertilizers:a,userLevel:i,language:o,environmentalData:l,growWeek:c,strainType:u,showFloatingWidget:h=!0,enableProactiveAlerts:x=!0,onNutrientAdjustment:d,onRecommendationApplied:g})=>{const[f,b]=p.useState(!1),y={nutrients:t,growthStage:s,waterType:n,waterVolume:r,selectedFertilizers:a,userLevel:i,language:o,environmentalData:l,growWeek:c,strainType:u},{messages:A,isLoading:S,sendMessage:I,hasActiveAlerts:R,hasUnreadMessages:m,activeRecommendations:v,isEnabled:z}=ns({autoAnalyze:!0,enableProactiveAlerts:x});p.useEffect(()=>{v.length>0&&g&&v.forEach(F=>{var _;if(((_=F.action)==null?void 0:_.type)==="adjust_nutrients"&&d){const K=k(F);Object.keys(K).length>0&&d(K)}})},[v,d,g]);const k=F=>{const _={};return F.description.includes("increase nitrogen")&&(_.n=t.n*1.1),F.description.includes("decrease nitrogen")&&(_.n=t.n*.9),F.description.includes("increase phosphorus")&&(_.p=t.p*1.1),F.description.includes("decrease phosphorus")&&(_.p=t.p*.9),F.description.includes("increase potassium")&&(_.k=t.k*1.1),F.description.includes("decrease potassium")&&(_.k=t.k*.9),_};return e.jsxs(e.Fragment,{children:[h&&z&&e.jsx(Qn,{onClick:()=>b(!0),context:y,hasUnreadMessages:m,hasActiveAlerts:R}),e.jsx(rs,{isOpen:f,onClose:()=>b(!1),onSendMessage:I,context:y,messages:A,isLoading:S})]})};class er{constructor(){Q(this,"metrics",{loadTime:0,renderTime:0,interactionTime:0,bundleSize:0,memoryUsage:0});Q(this,"interactions",[]);Q(this,"startTime",performance.now());this.initializeMonitoring()}initializeMonitoring(){window.addEventListener("load",()=>{this.trackLoadTime()}),this.trackCoreWebVitals(),this.trackUserInteractions(),this.trackMemoryUsage()}trackLoadTime(){const s=performance.getEntriesByType("navigation")[0];s&&(this.metrics.loadTime=s.loadEventEnd-s.fetchStart,this.metrics.renderTime=s.domContentLoadedEventEnd-s.fetchStart)}trackCoreWebVitals(){new PerformanceObserver(s=>{for(const n of s.getEntries())n.name==="first-contentful-paint"&&console.log("FCP:",n.startTime)}).observe({entryTypes:["paint"]}),new PerformanceObserver(s=>{for(const n of s.getEntries())console.log("LCP:",n.startTime)}).observe({entryTypes:["largest-contentful-paint"]}),new PerformanceObserver(s=>{for(const n of s.getEntries())n.hadRecentInput||console.log("CLS:",n.value)}).observe({entryTypes:["layout-shift"]})}trackUserInteractions(){document.addEventListener("click",s=>{const n=s.target;(n.tagName==="BUTTON"||n.closest("button"))&&this.recordInteraction({action:"click",timestamp:performance.now(),element:n.textContent||n.className})}),document.addEventListener("input",s=>{const n=s.target;(n.tagName==="INPUT"||n.tagName==="SELECT")&&this.recordInteraction({action:"input",timestamp:performance.now(),element:n.id||n.className})}),document.addEventListener("click",s=>{var r;const n=s.target;n.closest('[data-testid^="tab-"]')&&this.recordInteraction({action:"navigation",timestamp:performance.now(),element:((r=n.closest('[data-testid^="tab-"]'))==null?void 0:r.getAttribute("data-testid"))||"unknown"})})}trackMemoryUsage(){if("memory"in performance){const s=performance.memory;this.metrics.memoryUsage=s.usedJSHeapSize}}recordInteraction(s){this.interactions.push(s),this.interactions.length>100&&(this.interactions=this.interactions.slice(-100))}getMetrics(){return{...this.metrics}}getInteractions(){return[...this.interactions]}getSessionDuration(){return performance.now()-this.startTime}generateReport(){const s=this.getMetrics(),n=this.getSessionDuration(),r=this.interactions.length;return`
Performance Report:
==================
Load Time: ${s.loadTime.toFixed(2)}ms
Render Time: ${s.renderTime.toFixed(2)}ms
Session Duration: ${(n/1e3).toFixed(2)}s
User Interactions: ${r}
Memory Usage: ${(s.memoryUsage/1024/1024).toFixed(2)}MB

Recent Interactions:
${this.interactions.slice(-5).map(a=>`- ${a.action} on ${a.element} at ${(a.timestamp/1e3).toFixed(2)}s`).join(`
`)}
    `.trim()}exportData(){return{metrics:this.getMetrics(),interactions:this.getInteractions(),sessionDuration:this.getSessionDuration(),timestamp:new Date().toISOString(),userAgent:navigator.userAgent,viewport:{width:window.innerWidth,height:window.innerHeight}}}}const tr=new er,$e=(t,s)=>{console.log(`Custom Event: ${t}`,s),tr.recordInteraction({action:`custom:${t}`,timestamp:performance.now(),element:JSON.stringify(s)})},sr=({nutrients:t={},stage:s={},fields:n=[]})=>e.jsx("div",{className:"space-y-3",children:n.map(r=>{const a=t[r.key]??0,i=s[r.key],o=Vt(a,i),l=o==="optimal"?"bg-green-500":o==="suboptimal"?"bg-yellow-500":"bg-red-500",c="bg-slate-200 dark:bg-slate-700",u=Be(a,i);return e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex justify-between items-center text-xs font-medium",children:[e.jsx("span",{children:r.label}),e.jsxs("span",{children:[a,r.unit?` ${r.unit}`:"",i?e.jsxs("span",{className:"ml-2 text-slate-500 dark:text-slate-400 text-xs",children:["(",i[0],"–",i[1],")"]}):null]})]}),e.jsxs("div",{className:`relative w-full h-4 rounded ${c}`,"aria-label":`${r.label} Wert: ${a}`,children:[e.jsx("div",{className:`absolute left-0 top-0 h-4 rounded ${l}`,style:{width:`${u}%`,minWidth:u>0?"0.5rem":0,transition:"width 0.3s"},"aria-valuenow":a,"aria-valuemin":i?i[0]:0,"aria-valuemax":i?i[1]*1.2:100,role:"progressbar"}),i&&e.jsx("div",{className:"absolute top-0 h-4 border-l-2 border-blue-500 opacity-60",style:{left:`${Be(i[0],i)}%`},"aria-hidden":"true"}),i&&e.jsx("div",{className:"absolute top-0 h-4 border-l-2 border-blue-500 opacity-60",style:{left:`${Be(i[1],i)}%`},"aria-hidden":"true"})]})]},r.key)})}),nr=({fertilizerDatabase:t,GROWTH_STAGES:s,WATER_TYPES:n})=>{var R;if(!t||!s||!n)return e.jsx("div",{className:"max-w-lg mx-auto p-4 bg-white dark:bg-slate-800 rounded-lg shadow",children:"Daten werden geladen..."});const[r,a]=p.useState(1),[i,o]=p.useState(10),[l,c]=p.useState(Object.keys(n)[0]),[u,h]=p.useState(Object.keys(s)[0]),[x,d]=p.useState([]),[g,f]=p.useState({nutrients:{},contributions:{},stage:s[u]});p.useEffect(()=>{const m=Gt({waterVolume:i,growthStage:u,waterType:l,selectedFertilizers:x,fertilizerDatabase:t,NUTRIENT_FIELDS:[{key:"n"},{key:"p"},{key:"k"},{key:"ec"},{key:"ph"}],GROWTH_STAGES:s,WATER_TYPES:n,customWaterProfile:{},mixedWater:void 0});f(m)},[i,u,l,x,t,s,n]);const b=m=>{if(!m||x.find(z=>z.id===m))return;const v=t[m];d(z=>[...z,{id:m,amount:(v==null?void 0:v.type)==="powder"?.1:1}])},y=m=>{d(v=>v.filter(z=>z.id!==m))},A=(m,v)=>{const z=parseFloat(v);d(k=>k.map(F=>F.id===m?{...F,amount:isNaN(z)||z<0?0:z}:F))},S=x.map(m=>{const v=t[m.id];return v?`${v.name}: ${m.amount} ${v.unit||(v.type==="powder"?"g":"ml")}`:""}).filter(Boolean),I=()=>{const m={waterAmount:i,waterType:l,growthStage:u,selectedFertilizers:x,date:new Date().toISOString()},v=new Blob([JSON.stringify(m,null,2)],{type:"application/json"}),z=URL.createObjectURL(v),k=document.createElement("a");k.href=z,k.download="nutricalc-mix.json",document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(z)};return e.jsxs("div",{className:"max-w-lg mx-auto p-4 bg-white dark:bg-slate-800 rounded-lg shadow space-y-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800 dark:text-slate-100 mb-4",children:"Misch-Assistent"}),e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:`w-8 h-8 flex items-center justify-center rounded-full ${r===1?"bg-blue-600 text-white":"bg-slate-300 dark:bg-slate-700 text-slate-700 dark:text-slate-200"}`,children:"1"}),e.jsx("span",{className:"text-sm",children:"Wasser & Phase"}),e.jsx("div",{className:"w-6 h-0.5 bg-slate-300 dark:bg-slate-700 mx-2"}),e.jsx("div",{className:`w-8 h-8 flex items-center justify-center rounded-full ${r===2?"bg-blue-600 text-white":"bg-slate-300 dark:bg-slate-700 text-slate-700 dark:text-slate-200"}`,children:"2"}),e.jsx("span",{className:"text-sm",children:"Dünger"}),e.jsx("div",{className:"w-6 h-0.5 bg-slate-300 dark:bg-slate-700 mx-2"}),e.jsx("div",{className:`w-8 h-8 flex items-center justify-center rounded-full ${r===3?"bg-blue-600 text-white":"bg-slate-300 dark:bg-slate-700 text-slate-700 dark:text-slate-200"}`,children:"3"}),e.jsx("span",{className:"text-sm",children:"Anleitung"})]}),r===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"waterAmount",children:"Wassermenge (L)"}),e.jsx("input",{id:"waterAmount",type:"number",min:"0.1",step:"0.1",value:i,onChange:m=>o(Math.max(.1,Number(m.target.value))),className:"w-full px-2 py-1 border rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-slate-100",placeholder:"z.B. 10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"waterType",children:"Wassertyp"}),e.jsx("select",{id:"waterType",value:l,onChange:m=>c(m.target.value),className:"w-full px-2 py-1 border rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-slate-100",children:Object.entries(n).map(([m,v])=>e.jsx("option",{value:m,children:v.name},m))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"growthStage",children:"Wachstumsphase"}),e.jsx("select",{id:"growthStage",value:u,onChange:m=>h(m.target.value),className:"w-full px-2 py-1 border rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-slate-100",children:Object.entries(s).map(([m,v])=>e.jsx("option",{value:m,children:v.name},m))})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(M,{onClick:()=>a(2),variant:"primary",children:"Weiter"})})]}),r===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Dünger auswählen"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:Object.entries(t).map(([m,v])=>e.jsx(M,{variant:"secondary",onClick:()=>b(m),disabled:!!x.find(z=>z.id===m),className:"text-xs mb-1",children:v.name},m))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ausgewählte Dünger & Mengen"}),e.jsxs("ul",{className:"space-y-2",children:[x.length===0&&e.jsx("li",{className:"text-slate-500",children:"Noch keine Dünger ausgewählt."}),x.map(m=>{const v=t[m.id];return e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"flex-1",children:(v==null?void 0:v.name)||m.id}),e.jsx("input",{type:"number",min:"0",step:"0.01",value:m.amount,onChange:z=>A(m.id,z.target.value),className:"w-20 px-2 py-1 border rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-slate-100 text-xs"}),e.jsx("span",{className:"text-xs",children:(v==null?void 0:v.unit)||((v==null?void 0:v.type)==="powder"?"g":"ml")}),e.jsx(M,{onClick:()=>y(m.id),variant:"danger",className:"text-xs",children:"Entfernen"})]},m.id)})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-md font-semibold text-slate-800 dark:text-slate-100 mb-2",children:"Nährstoffwerte (Live)"}),e.jsx(sr,{nutrients:g.nutrients,stage:g.stage,fields:[{key:"n",label:"N (Stickstoff)",unit:"ppm"},{key:"p",label:"P (Phosphor)",unit:"ppm"},{key:"k",label:"K (Kalium)",unit:"ppm"},{key:"ec",label:"EC",unit:"mS/cm"},{key:"ph",label:"pH",unit:""}]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(M,{onClick:()=>a(1),variant:"secondary",children:"Zurück"}),e.jsx(M,{onClick:()=>a(3),variant:"primary",disabled:x.length===0,children:"Weiter"})]})]}),r===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-md font-semibold mb-2",children:"Mischanleitung"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[e.jsxs("li",{children:["Fülle ",e.jsxs("span",{className:"font-bold",children:[i," L"]})," Wasser (",((R=n[l])==null?void 0:R.name)||l,") in einen sauberen Behälter."]}),S.map((m,v)=>e.jsxs("li",{children:["Füge ",e.jsx("span",{className:"font-bold",children:m})," hinzu und gut umrühren."]},v)),e.jsx("li",{children:"Überprüfe den pH- und EC-Wert und passe ggf. an."})]}),e.jsx("div",{className:"text-xs text-slate-500 mt-2",children:"Hinweis: Reihenfolge kann je nach Dünger variieren. Immer Herstellerhinweise beachten."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(M,{onClick:()=>a(2),variant:"secondary",children:"Zurück"}),e.jsx(M,{onClick:I,variant:"primary",children:"Mix als JSON exportieren"})]})]})]})},vt="nutricalc_watering_events",Ie={id:null,date:"",time:"",amount:"",notes:""},rr=()=>{const[t,s]=p.useState([]),[n,r]=p.useState(Ie),[a,i]=p.useState(null);p.useEffect(()=>{const d=localStorage.getItem(vt);if(d)try{s(JSON.parse(d))}catch{}},[]),p.useEffect(()=>{localStorage.setItem(vt,JSON.stringify(t))},[t]);const o=d=>{const{name:g,value:f}=d.target;r(b=>({...b,[g]:f}))},l=d=>{if(d.preventDefault(),!n.date||!n.time||!n.amount)return;const g={...n,id:a||Date.now()};s(a?f=>f.map(b=>b.id===a?g:b):f=>[...f,g]),r(Ie),i(null)},c=d=>{const g=t.find(f=>f.id===d);g&&(r(g),i(d))},u=d=>{s(g=>g.filter(f=>f.id!==d)),a===d&&(r(Ie),i(null))},h=[...t].sort((d,g)=>{const f=new Date(`${d.date}T${d.time}`),b=new Date(`${g.date}T${g.time}`);return f-b}),x=new Date().toISOString().split("T")[0];return e.jsxs("div",{className:"max-w-lg mx-auto p-4 bg-white dark:bg-slate-800 rounded-lg shadow space-y-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800 dark:text-slate-100 mb-4",children:"Gießplaner"}),e.jsxs("form",{onSubmit:l,className:"space-y-3 bg-slate-100 dark:bg-slate-900/50 p-3 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-medium mb-0.5",htmlFor:"date",children:"Datum"}),e.jsx("input",{type:"date",id:"date",name:"date",min:x,value:n.date,onChange:o,className:"w-full px-2 py-1 border rounded-md dark:bg-slate-700 dark:text-slate-100 text-xs",required:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-medium mb-0.5",htmlFor:"time",children:"Uhrzeit"}),e.jsx("input",{type:"time",id:"time",name:"time",value:n.time,onChange:o,className:"w-full px-2 py-1 border rounded-md dark:bg-slate-700 dark:text-slate-100 text-xs",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-0.5",htmlFor:"amount",children:"Menge (L)"}),e.jsx("input",{type:"number",id:"amount",name:"amount",min:"0.1",step:"0.1",value:n.amount,onChange:o,className:"w-full px-2 py-1 border rounded-md dark:bg-slate-700 dark:text-slate-100 text-xs",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-0.5",htmlFor:"notes",children:"Notizen"}),e.jsx("input",{type:"text",id:"notes",name:"notes",value:n.notes,onChange:o,className:"w-full px-2 py-1 border rounded-md dark:bg-slate-700 dark:text-slate-100 text-xs"})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[a&&e.jsx(M,{type:"button",onClick:()=>{r(Ie),i(null)},variant:"secondary",children:"Abbrechen"}),e.jsx(M,{type:"submit",variant:"primary",children:a?"Speichern":"Hinzufügen"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Geplante Gießtermine"}),h.length===0&&e.jsx("div",{className:"text-slate-500",children:"Noch keine Gießtermine."}),e.jsx("ul",{className:"space-y-2",children:h.map(d=>e.jsxs("li",{className:"flex items-center gap-2 p-2 bg-slate-100 dark:bg-slate-700 rounded",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-medium text-sm",children:[d.date," ",d.time," - ",d.amount," L"]}),d.notes&&e.jsx("div",{className:"text-xs text-slate-500",children:d.notes})]}),e.jsx(M,{onClick:()=>c(d.id),variant:"secondary",className:"text-xs",children:"Bearbeiten"}),e.jsx(M,{onClick:()=>u(d.id),variant:"danger",className:"text-xs",children:"Löschen"})]},d.id))})]})]})},ar=()=>{const{theme:t,toggleTheme:s}=St();return e.jsx("button",{onClick:s,className:"p-2 rounded-md hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:"Toggle Dark Mode",children:t==="light"?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 3v1m0 16v1m8.66-13.66l-.71.71M4.05 19.07l-.71.71M21 12h-1M4 12H3m16.66 5.66l-.71-.71M4.05 4.93l-.71-.71"})}):e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M21 12.79A9 9 0 1111.21 3a7 7 0 109.79 9.79z"})})})};function wt(t,s){const n={};return(s||[]).forEach(r=>{const a=r.id||`custom_${r.name.replace(/\s+/g,"_").toLowerCase()}_${Date.now()}`,i={};Object.entries(r.composition||{}).forEach(([o,l])=>{i[o.toLowerCase()]=Number(l)||0}),n[a]={...r,id:a,name:r.name,type:r.type||"liquid",unit:r.unit||"ml",composition:i,description:r.description||"Benutzerdefinierter Dünger"}}),{...t,...n}}const ir=()=>{var R,m,v,z,k,F;const[t,s]=p.useState(V[0].id),n=_=>{$e("tab_switch",{from:t,to:_}),s(_)},[r,a]=p.useState(()=>{const _=localStorage.getItem(ge);let K=[];try{_&&(K=JSON.parse(_))}catch{}return wt(at,K)}),[i,o]=p.useState({NUTRIENT_FIELDS:re,GROWTH_STAGES:oe,WATER_TYPES:he,fertilizerDatabase:r,selectedFertilizers:[],waterVolume:10,growthStage:Object.keys(oe)[0],waterType:Object.keys(he)[0],customWaterProfile:{},results:{nutrients:{},contributions:{},stage:oe[Object.keys(oe)[0]]}}),{apiKey:l}=Jt(),{addToast:c}=be(),[u,h]=p.useState(!1),[x,d]=p.useState("Hallo! Ich bin dein KI-Helfer. Frag mich z.B. 'Wie erstelle ich einen Dünger?' oder 'Ist mein N-Wert ok?' oder 'Was ist EC?'"),{mixedWater:g}=Wt(),f=["Wie erstelle ich einen Dünger?","Ist mein N-Wert ok?","Was ist EC?"],b=U.useCallback(_=>{o(_)},[]),y=U.useCallback(_=>{o(K=>({...K,results:{...K.results,nutrients:{...K.results.nutrients,..._}}})),c("AI-Empfehlungen angewendet","success"),$e("ai_recommendation_applied",{adjustments:_})},[c]),A=U.useCallback(_=>{$e("ai_recommendation_applied",{type:_.type,priority:_.priority})},[]),S=U.useCallback(()=>{const _=localStorage.getItem(ge);let K=[];try{_&&(K=JSON.parse(_))}catch{}a(wt(at,K))},[]);U.useEffect(()=>{const _=K=>{K.key===ge&&S()};return window.addEventListener("storage",_),()=>window.removeEventListener("storage",_)},[]);const I=async _=>{var K,ee,se,te,W,B,L,j;if(!l){c("API Key fehlt! Bitte geben Sie Ihren Google Gemini API Key in den Einstellungen ein.","error",8e3);return}if(!_.trim()){c("Bitte geben Sie eine Nachricht ein.","warning");return}h(!0),d("Denke nach...");try{const w=new AbortController,T=setTimeout(()=>w.abort(),3e4),E=await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent",{method:"POST",headers:{"Content-Type":"application/json","x-goog-api-key":l},body:JSON.stringify({contents:[{role:"user",parts:[{text:_}]}],generationConfig:{temperature:.6,maxOutputTokens:150},safetySettings:[{category:"HARM_CATEGORY_HARASSMENT",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_HATE_SPEECH",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_SEXUALLY_EXPLICIT",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_DANGEROUS_CONTENT",threshold:"BLOCK_MEDIUM_AND_ABOVE"}]}),signal:w.signal});if(clearTimeout(T),E.ok){const D=await E.json();if((B=(W=(te=(se=(ee=D.candidates)==null?void 0:ee[0])==null?void 0:se.content)==null?void 0:te.parts)==null?void 0:W[0])!=null&&B.text)d(D.candidates[0].content.parts[0].text.trim());else if((L=D.promptFeedback)!=null&&L.blockReason){const O=D.promptFeedback.blockReason;d(`Anfrage blockiert: ${O}. Bitte formulieren Sie Ihre Frage anders.`),c(`Anfrage blockiert: ${O}. Bitte formulieren Sie Ihre Frage anders.`,"warning",8e3)}else d("Keine Antwort erhalten. Bitte versuchen Sie es erneut."),c("Keine Antwort von der AI erhalten.","warning")}else{let D=`HTTP ${E.status}`;try{D=((K=(await E.json()).error)==null?void 0:K.message)||D,E.status===400?D="Ungültige Anfrage. Bitte überprüfen Sie Ihren API Key.":E.status===401?D="API Key ungültig oder abgelaufen. Bitte überprüfen Sie Ihren API Key.":E.status===403?D="Zugriff verweigert. Bitte überprüfen Sie Ihre API Key Berechtigungen.":E.status===429?D="Zu viele Anfragen. Bitte warten Sie einen Moment und versuchen Sie es erneut.":E.status>=500&&(D="Server-Fehler. Bitte versuchen Sie es später erneut.")}catch{}d(`AI Fehler: ${D}`),c(`API Fehler: ${D}`,"error",8e3)}}catch(w){let T="Fehler bei der Antwortgenerierung.";w instanceof Error&&(w.name==="AbortError"?T="Anfrage-Timeout. Bitte versuchen Sie es erneut.":(j=w.message)!=null&&j.includes("Failed to fetch")?T="Netzwerkfehler. Bitte überprüfen Sie Ihre Internetverbindung.":T=`Fehler: ${w.message}`),d(T),c(T,"error",8e3)}finally{h(!1)}};return e.jsx(De,{children:e.jsxs("div",{className:"min-h-screen bg-stone-50 transition-colors duration-300",children:[e.jsx(In,{activeTab:t,setActiveTab:n}),e.jsx("header",{className:"md:ml-64 bg-white/80 backdrop-blur-sm border-b border-stone-200 sticky top-0 z-40",children:e.jsxs("div",{className:"px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-stone-900",children:((R=V.find(_=>_.id===t))==null?void 0:R.label)||"NutriCalc"}),e.jsx("p",{className:"text-stone-600 text-sm",children:((m=V.find(_=>_.id===t))==null?void 0:m.description)||"Nutrient calculation and analysis"})]}),e.jsx(ar,{})]}),e.jsx(De,{children:e.jsx(Kt,{apiKey:!!l,onSend:I,isLoading:u,displayMessage:x,suggestions:f})})]})}),e.jsx("main",{className:"md:ml-64 px-6 py-8 pb-20 md:pb-8",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs(De,{children:[t===V[0].id&&e.jsx(mn,{NUTRIENT_FIELDS:re,GROWTH_STAGES:oe,WATER_TYPES:he,fertilizerDatabase:r,onAnalysisUpdate:b,mixedWater:g}),t===V[1].id&&e.jsx(bn,{results:i.results}),t===V[2].id&&e.jsx(pn,{...i}),t===V[3].id&&e.jsx(hn,{refreshFertilizerDatabase:S}),t===Bt&&e.jsx(Zn,{context:{nutrients:i.results.nutrients||{},growthStage:i.growthStage,waterType:i.waterType,waterVolume:i.waterVolume,selectedFertilizers:i.selectedFertilizers,userLevel:"intermediate",language:"de",environmentalData:{ph:(v=i.results.nutrients)==null?void 0:v.ph,ec:(z=i.results.nutrients)==null?void 0:z.ec}}}),t===Ue&&e.jsx(An,{}),t===Dt&&e.jsx(nr,{fertilizerDatabase:r,GROWTH_STAGES:oe,WATER_TYPES:he}),t===Ft&&e.jsx(rr,{}),t===V[V.length-1].id&&e.jsx(yn,{})]})})}),t!==Ue&&e.jsx(Xn,{nutrients:i.results.nutrients||{},growthStage:i.growthStage,waterType:i.waterType,waterVolume:i.waterVolume,selectedFertilizers:i.selectedFertilizers,userLevel:"intermediate",language:"de",environmentalData:{ph:(k=i.results.nutrients)==null?void 0:k.ph,ec:(F=i.results.nutrients)==null?void 0:F.ec},showFloatingWidget:!0,enableProactiveAlerts:!0,onNutrientAdjustment:y,onRecommendationApplied:A})]})})},or=()=>e.jsx(ps,{children:e.jsx(Xs,{children:e.jsx(an,{children:e.jsx(ir,{})})})});We.createRoot(document.getElementById("root")).render(e.jsx(U.StrictMode,{children:e.jsx(or,{})}));
//# sourceMappingURL=index-87650a9e.js.map
